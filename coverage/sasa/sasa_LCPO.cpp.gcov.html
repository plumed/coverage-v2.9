<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - plumed test coverage - sasa/sasa_LCPO.cpp</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../index.html">top level</a> - <a href="index.html">sasa</a> - sasa_LCPO.cpp<span style="font-size: 80%;"> (source / <a href="sasa_LCPO.cpp.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">plumed test coverage</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">519</td>
            <td class="headerCovTableEntry">631</td>
            <td class="headerCovTableEntryMed">82.3 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2024-10-18 14:29:08</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">13</td>
            <td class="headerCovTableEntry">16</td>
            <td class="headerCovTableEntryMed">81.2 %</td>
          </tr>
          <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</a>
<a name="2"><span class="lineNum">       2 </span>            : Copyright (c) 2021, Andrea Arsiccio</a>
<a name="3"><span class="lineNum">       3 </span>            : </a>
<a name="4"><span class="lineNum">       4 </span>            : This software is provided 'as-is', without any express or implied</a>
<a name="5"><span class="lineNum">       5 </span>            : warranty. In no event will the authors be held liable for any damages</a>
<a name="6"><span class="lineNum">       6 </span>            : arising from the use of this software.</a>
<a name="7"><span class="lineNum">       7 </span>            : </a>
<a name="8"><span class="lineNum">       8 </span>            : Permission is granted to anyone to use this software for any purpose,</a>
<a name="9"><span class="lineNum">       9 </span>            : including commercial applications, and to alter it and redistribute it</a>
<a name="10"><span class="lineNum">      10 </span>            : freely, subject to the following restrictions:</a>
<a name="11"><span class="lineNum">      11 </span>            : </a>
<a name="12"><span class="lineNum">      12 </span>            : 1. The origin of this software must not be misrepresented; you must not</a>
<a name="13"><span class="lineNum">      13 </span>            :    claim that you wrote the original software. If you use this software</a>
<a name="14"><span class="lineNum">      14 </span>            :    in a product, an acknowledgment in the product documentation would be</a>
<a name="15"><span class="lineNum">      15 </span>            :    appreciated but is not required.</a>
<a name="16"><span class="lineNum">      16 </span>            : 2. Altered source versions must be plainly marked as such, and must not be</a>
<a name="17"><span class="lineNum">      17 </span>            :    misrepresented as being the original software.</a>
<a name="18"><span class="lineNum">      18 </span>            : 3. This notice may not be removed or altered from any source distribution.</a>
<a name="19"><span class="lineNum">      19 </span>            : +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */</a>
<a name="20"><span class="lineNum">      20 </span>            : </a>
<a name="21"><span class="lineNum">      21 </span>            : #include &quot;Sasa.h&quot;</a>
<a name="22"><span class="lineNum">      22 </span>            : #include &quot;ActionRegister.h&quot;</a>
<a name="23"><span class="lineNum">      23 </span>            : #include &quot;core/PlumedMain.h&quot;</a>
<a name="24"><span class="lineNum">      24 </span>            : #include &quot;core/GenericMolInfo.h&quot;</a>
<a name="25"><span class="lineNum">      25 </span>            : #include &quot;core/ActionSet.h&quot;</a>
<a name="26"><span class="lineNum">      26 </span>            : #include &lt;cstdio&gt;</a>
<a name="27"><span class="lineNum">      27 </span>            : #include &lt;iostream&gt;</a>
<a name="28"><span class="lineNum">      28 </span>            : #include &lt;string&gt;</a>
<a name="29"><span class="lineNum">      29 </span>            : #include &lt;cmath&gt;</a>
<a name="30"><span class="lineNum">      30 </span>            : #include &lt;sstream&gt;</a>
<a name="31"><span class="lineNum">      31 </span>            : #include &lt;algorithm&gt;</a>
<a name="32"><span class="lineNum">      32 </span>            : #include &lt;iterator&gt;</a>
<a name="33"><span class="lineNum">      33 </span>            : #include &lt;fstream&gt;</a>
<a name="34"><span class="lineNum">      34 </span>            : </a>
<a name="35"><span class="lineNum">      35 </span>            : </a>
<a name="36"><span class="lineNum">      36 </span>            : using namespace std;</a>
<a name="37"><span class="lineNum">      37 </span>            : </a>
<a name="38"><span class="lineNum">      38 </span>            : namespace PLMD {</a>
<a name="39"><span class="lineNum">      39 </span>            : namespace sasa {</a>
<a name="40"><span class="lineNum">      40 </span>            : </a>
<a name="41"><span class="lineNum">      41 </span>            : //+PLUMEDOC SASAMOD_COLVAR SASA_LCPO</a>
<a name="42"><span class="lineNum">      42 </span>            : /*</a>
<a name="43"><span class="lineNum">      43 </span>            : Calculates the solvent accessible surface area (SASA) of a protein molecule, or other properties related to it.</a>
<a name="44"><span class="lineNum">      44 </span>            : </a>
<a name="45"><span class="lineNum">      45 </span>            : The atoms for which the SASA is desired should be indicated with the keyword ATOMS, and a pdb file of the protein must be provided in input with the MOLINFO keyword. The LCPO algorithm is used for the calculation (please, read and cite \cite Weiser1999). The radius of the solvent is assumed to be 0.14 nm, which is the radius of water molecules. Using the keyword NL_STRIDE it is also possible to specify the frequency with which the neighbor list for the calculation of the SASA is updated (the default is every 10 steps).</a>
<a name="46"><span class="lineNum">      46 </span>            : </a>
<a name="47"><span class="lineNum">      47 </span>            : Different properties can be calculated and selected using the TYPE keyword:</a>
<a name="48"><span class="lineNum">      48 </span>            : </a>
<a name="49"><span class="lineNum">      49 </span>            : 1) the total SASA (TOTAL);</a>
<a name="50"><span class="lineNum">      50 </span>            : </a>
<a name="51"><span class="lineNum">      51 </span>            : 2) the free energy of transfer for the protein according to the transfer model (TRANSFER). This keyword can be used, for instance, to compute the transfer of a protein to different temperatures, as detailed in \cite Arsiccio-T-SASA-2021, or to different pressures, as detailed in \cite Arsiccio-P-SASA-2021, or to different osmolyte solutions, as detailed in \cite Arsiccio-C-SASA-2022.</a>
<a name="52"><span class="lineNum">      52 </span>            : </a>
<a name="53"><span class="lineNum">      53 </span>            : </a>
<a name="54"><span class="lineNum">      54 </span>            : When the TRANSFER keyword is used, a file with the free energy of transfer values for the sidechains and backbone atoms should be provided (using the keyword DELTAGFILE). Such file should have the following format:</a>
<a name="55"><span class="lineNum">      55 </span>            : </a>
<a name="56"><span class="lineNum">      56 </span>            : \verbatim</a>
<a name="57"><span class="lineNum">      57 </span>            : ----------------Sample DeltaG.dat file---------------------</a>
<a name="58"><span class="lineNum">      58 </span>            : ALA     0.711019999999962</a>
<a name="59"><span class="lineNum">      59 </span>            : ARG     -2.24832799999996</a>
<a name="60"><span class="lineNum">      60 </span>            : ASN     -2.74838799999999</a>
<a name="61"><span class="lineNum">      61 </span>            : ASP     -2.5626376</a>
<a name="62"><span class="lineNum">      62 </span>            : CYS     3.89864000000006</a>
<a name="63"><span class="lineNum">      63 </span>            : GLN     -1.76192</a>
<a name="64"><span class="lineNum">      64 </span>            : GLU     -2.38664400000002</a>
<a name="65"><span class="lineNum">      65 </span>            : GLY     0</a>
<a name="66"><span class="lineNum">      66 </span>            : HIS     -3.58152799999999</a>
<a name="67"><span class="lineNum">      67 </span>            : ILE     2.42634399999986</a>
<a name="68"><span class="lineNum">      68 </span>            : LEU     1.77233599999988</a>
<a name="69"><span class="lineNum">      69 </span>            : LYS     -1.92576400000002</a>
<a name="70"><span class="lineNum">      70 </span>            : MET     -0.262827999999956</a>
<a name="71"><span class="lineNum">      71 </span>            : PHE     1.62028800000007</a>
<a name="72"><span class="lineNum">      72 </span>            : PRO     -2.15598800000001</a>
<a name="73"><span class="lineNum">      73 </span>            : SER     -1.60934800000004</a>
<a name="74"><span class="lineNum">      74 </span>            : THR     -0.591559999999987</a>
<a name="75"><span class="lineNum">      75 </span>            : TRP     1.22936000000027</a>
<a name="76"><span class="lineNum">      76 </span>            : TYR     0.775547999999958</a>
<a name="77"><span class="lineNum">      77 </span>            : VAL     2.12779200000011</a>
<a name="78"><span class="lineNum">      78 </span>            : BACKBONE        1.00066920000002</a>
<a name="79"><span class="lineNum">      79 </span>            : -----------------------------------------------------------</a>
<a name="80"><span class="lineNum">      80 </span>            : \endverbatim</a>
<a name="81"><span class="lineNum">      81 </span>            : </a>
<a name="82"><span class="lineNum">      82 </span>            : where the second column is the free energy of transfer for each sidechain/backbone, in kJ/mol.</a>
<a name="83"><span class="lineNum">      83 </span>            : </a>
<a name="84"><span class="lineNum">      84 </span>            : A Python script for the computation of free energy of transfer values to describe the effect of osmolyte concentration, temperature and pressure (according to \cite Arsiccio-C-SASA-2022, \cite Arsiccio-T-SASA-2021 and \cite Arsiccio-P-SASA-2021) is freely available at https://github.com/andrea-arsiccio/DeltaG-calculation. The script automatically outputs a DeltaG.dat file compatible with this SASA module.</a>
<a name="85"><span class="lineNum">      85 </span>            : </a>
<a name="86"><span class="lineNum">      86 </span>            : If the DELTAGFILE is not provided, the program computes the free energy of transfer values as if they had to take into account the effect of temperature according to approaches 2 or 3 in the paper \cite Arsiccio-T-SASA-2021. Please read and cite this paper if using the transfer model for computing the effect of temperature in implicit solvent simulations. For this purpose, the keyword APPROACH should be added, and set to either 2 or 3.</a>
<a name="87"><span class="lineNum">      87 </span>            : </a>
<a name="88"><span class="lineNum">      88 </span>            : The SASA usually makes sense when atoms used for the calculation are all part of the same molecule. When running with periodic boundary conditions, the atoms should be in the proper periodic image. This is done automatically since PLUMED 2.2, by considering the ordered list of atoms and rebuilding the broken entities using a procedure that is equivalent to that done in \ref WHOLEMOLECULES. Notice that rebuilding is local to this action. This is different from \ref WHOLEMOLECULES which actually modifies the coordinates stored in PLUMED.</a>
<a name="89"><span class="lineNum">      89 </span>            : </a>
<a name="90"><span class="lineNum">      90 </span>            : In case you want to recover the old behavior you should use the NOPBC flag.</a>
<a name="91"><span class="lineNum">      91 </span>            : In that case you need to take care that atoms are in the correct periodic image.</a>
<a name="92"><span class="lineNum">      92 </span>            : </a>
<a name="93"><span class="lineNum">      93 </span>            : The SASA may also be computed using the SASA_HASEL collective variable, which makes use of the algorithm described in \cite Hasel1988. SASA_HASEL is less accurate then SASA_LCPO, but the computation is faster.</a>
<a name="94"><span class="lineNum">      94 </span>            : </a>
<a name="95"><span class="lineNum">      95 </span>            : </a>
<a name="96"><span class="lineNum">      96 </span>            : </a>
<a name="97"><span class="lineNum">      97 </span>            : \par Examples</a>
<a name="98"><span class="lineNum">      98 </span>            : </a>
<a name="99"><span class="lineNum">      99 </span>            : The following input tells plumed to print the total SASA for atoms 10 to 20 in a protein chain.</a>
<a name="100"><span class="lineNum">     100 </span>            : \plumedfile</a>
<a name="101"><span class="lineNum">     101 </span>            : SASA_LCPO TYPE=TOTAL ATOMS=10-20 NL_STRIDE=10 LABEL=sasa</a>
<a name="102"><span class="lineNum">     102 </span>            : PRINT ARG=sasa STRIDE=1 FILE=colvar</a>
<a name="103"><span class="lineNum">     103 </span>            : \endplumedfile</a>
<a name="104"><span class="lineNum">     104 </span>            : </a>
<a name="105"><span class="lineNum">     105 </span>            : </a>
<a name="106"><span class="lineNum">     106 </span>            : The following input tells plumed to compute the transfer free energy for the protein chain containing atoms 10 to 20. Such transfer free energy is then used as a bias in the simulation (e.g., implicit solvent simulations). The free energy of transfer values are read from a file called DeltaG.dat.</a>
<a name="107"><span class="lineNum">     107 </span>            : </a>
<a name="108"><span class="lineNum">     108 </span>            : \plumedfile</a>
<a name="109"><span class="lineNum">     109 </span>            : SASA_LCPO TYPE=TRANSFER ATOMS=10-20 NL_STRIDE=10 DELTAGFILE=DeltaG.dat LABEL=sasa</a>
<a name="110"><span class="lineNum">     110 </span>            : </a>
<a name="111"><span class="lineNum">     111 </span>            : bias: BIASVALUE ARG=sasa</a>
<a name="112"><span class="lineNum">     112 </span>            : </a>
<a name="113"><span class="lineNum">     113 </span>            : PRINT ARG=sasa,bias.* STRIDE=1 FILE=colvar</a>
<a name="114"><span class="lineNum">     114 </span>            : \endplumedfile</a>
<a name="115"><span class="lineNum">     115 </span>            : </a>
<a name="116"><span class="lineNum">     116 </span>            : The following input tells plumed to compute the transfer free energy for the protein chain containing atoms 10 to 20. Such transfer free energy is then used as a bias in the simulation (e.g., implicit solvent simulations). The free energy of transfer values are computed according to \cite Arsiccio-T-SASA-2021, and take into account the effect of temperature using approach 2 as described in the paper.</a>
<a name="117"><span class="lineNum">     117 </span>            : </a>
<a name="118"><span class="lineNum">     118 </span>            : \plumedfile</a>
<a name="119"><span class="lineNum">     119 </span>            : SASA_LCPO TYPE=TRANSFER ATOMS=10-20 NL_STRIDE=10 APPROACH=2 LABEL=sasa</a>
<a name="120"><span class="lineNum">     120 </span>            : </a>
<a name="121"><span class="lineNum">     121 </span>            : bias: BIASVALUE ARG=sasa</a>
<a name="122"><span class="lineNum">     122 </span>            : </a>
<a name="123"><span class="lineNum">     123 </span>            : PRINT ARG=sasa,bias.* STRIDE=1 FILE=colvar</a>
<a name="124"><span class="lineNum">     124 </span>            : \endplumedfile</a>
<a name="125"><span class="lineNum">     125 </span>            : </a>
<a name="126"><span class="lineNum">     126 </span>            : */</a>
<a name="127"><span class="lineNum">     127 </span>            : //+ENDPLUMEDOC</a>
<a name="128"><span class="lineNum">     128 </span>            : </a>
<a name="129"><span class="lineNum">     129 </span>            : class SASA_LCPO : public Colvar {</a>
<a name="130"><span class="lineNum">     130 </span>            : private:</a>
<a name="131"><span class="lineNum">     131 </span>            :   enum CV_TYPE {TOTAL, TRANSFER};</a>
<a name="132"><span class="lineNum">     132 </span>            :   int sasa_type;</a>
<a name="133"><span class="lineNum">     133 </span>            :   bool nopbc;</a>
<a name="134"><span class="lineNum">     134 </span>            :   double rs;</a>
<a name="135"><span class="lineNum">     135 </span>            :   string DeltaGValues;</a>
<a name="136"><span class="lineNum">     136 </span>            :   int approach;</a>
<a name="137"><span class="lineNum">     137 </span>            :   unsigned stride;</a>
<a name="138"><span class="lineNum">     138 </span>            :   unsigned nl_update;</a>
<a name="139"><span class="lineNum">     139 </span>            :   int firstStepFlag;</a>
<a name="140"><span class="lineNum">     140 </span>            :   double Ti;</a>
<a name="141"><span class="lineNum">     141 </span>            :   // cppcheck-suppress duplInheritedMember</a>
<a name="142"><span class="lineNum">     142 </span>            :   std::vector&lt;AtomNumber&gt; atoms;</a>
<a name="143"><span class="lineNum">     143 </span>            :   vector &lt; vector &lt; std::string &gt; &gt; AtomResidueName;</a>
<a name="144"><span class="lineNum">     144 </span>            :   vector &lt; vector &lt; double &gt; &gt; LCPOparam;</a>
<a name="145"><span class="lineNum">     145 </span>            :   unsigned natoms;</a>
<a name="146"><span class="lineNum">     146 </span>            :   vector &lt; vector &lt; double &gt; &gt; MaxSurf;</a>
<a name="147"><span class="lineNum">     147 </span>            :   vector &lt; vector &lt; double &gt; &gt; DeltaG;</a>
<a name="148"><span class="lineNum">     148 </span>            :   vector &lt; vector &lt; int &gt; &gt; Nlist;</a>
<a name="149"><span class="lineNum">     149 </span>            : public:</a>
<a name="150"><span class="lineNum">     150 </span>            :   static void registerKeywords(Keywords&amp; keys);</a>
<a name="151"><span class="lineNum">     151 </span>            :   explicit SASA_LCPO(const ActionOptions&amp;);</a>
<a name="152"><span class="lineNum">     152 </span>            :   void readPDB();</a>
<a name="153"><span class="lineNum">     153 </span>            :   map&lt;string, vector&lt;double&gt; &gt; setupLCPOparam();</a>
<a name="154"><span class="lineNum">     154 </span>            :   void readLCPOparam();</a>
<a name="155"><span class="lineNum">     155 </span>            :   void calcNlist();</a>
<a name="156"><span class="lineNum">     156 </span>            :   map&lt;string, vector&lt;double&gt; &gt; setupMaxSurfMap();</a>
<a name="157"><span class="lineNum">     157 </span>            :   void readMaxSurf();</a>
<a name="158"><span class="lineNum">     158 </span>            :   void readDeltaG();</a>
<a name="159"><span class="lineNum">     159 </span>            :   void computeDeltaG();</a>
<a name="160"><span class="lineNum">     160 </span>            :   virtual void calculate();</a>
<a name="161"><span class="lineNum">     161 </span>            : };</a>
<a name="162"><span class="lineNum">     162 </span>            : </a>
<a name="163"><span class="lineNum">     163 </span><span class="lineCov">      12613 : PLUMED_REGISTER_ACTION(SASA_LCPO,&quot;SASA_LCPO&quot;)</span></a>
<a name="164"><span class="lineNum">     164 </span>            : </a>
<a name="165"><span class="lineNum">     165 </span><span class="lineCov">          4 : void SASA_LCPO::registerKeywords(Keywords&amp; keys) {</span></a>
<a name="166"><span class="lineNum">     166 </span><span class="lineCov">          4 :   Colvar::registerKeywords(keys);</span></a>
<a name="167"><span class="lineNum">     167 </span><span class="lineCov">          8 :   keys.add(&quot;atoms&quot;,&quot;ATOMS&quot;,&quot;the group of atoms that you are calculating the SASA for&quot;);</span></a>
<a name="168"><span class="lineNum">     168 </span><span class="lineCov">          8 :   keys.add(&quot;compulsory&quot;,&quot;TYPE&quot;,&quot;TOTAL&quot;,&quot;The type of calculation you want to perform. Can be TOTAL or TRANSFER&quot;);</span></a>
<a name="169"><span class="lineNum">     169 </span><span class="lineCov">          8 :   keys.add(&quot;compulsory&quot;, &quot;NL_STRIDE&quot;, &quot;The frequency with which the neighbor list is updated.&quot;);</span></a>
<a name="170"><span class="lineNum">     170 </span><span class="lineCov">          8 :   keys.add(&quot;optional&quot;,&quot;DELTAGFILE&quot;,&quot;a file containing the free energy values for backbone and sidechains. Necessary only if TYPE = TRANSFER. A Python script for the computation of free energy of transfer values to describe the effect of osmolyte concentration, temperature and pressure is freely available at https://github.com/andrea-arsiccio/DeltaG-calculation. The script automatically outputs a DeltaG.dat file compatible with this SASA module. If TYPE = TRANSFER and no DELTAGFILE is provided, the free energy values are those describing the effect of temperature, and are computed using the temperature value passed by the MD engine&quot;);</span></a>
<a name="171"><span class="lineNum">     171 </span><span class="lineCov">          8 :   keys.add(&quot;optional&quot;,&quot;APPROACH&quot;,&quot;either approach 2 or 3. Necessary only if TYPE = TRANSFER and no DELTAGFILE is provided. If TYPE = TRANSFER and no DELTAGFILE is provided, the free energy values are those describing the effect of temperature, and the program must know if approach 2 or 3 (as described in Arsiccio and Shea, Protein Cold Denaturation in Implicit Solvent Simulations: A Transfer Free Energy Approach, J. Phys. Chem. B, 2021) needs to be used to compute them&quot;);</span></a>
<a name="172"><span class="lineNum">     172 </span><span class="lineCov">          4 : }</span></a>
<a name="173"><span class="lineNum">     173 </span>            : </a>
<a name="174"><span class="lineNum">     174 </span>            : </a>
<a name="175"><span class="lineNum">     175 </span><span class="lineCov">          2 : SASA_LCPO::SASA_LCPO(const ActionOptions&amp;ao):</span></a>
<a name="176"><span class="lineNum">     176 </span>            :   PLUMED_COLVAR_INIT(ao),</a>
<a name="177"><span class="lineNum">     177 </span><span class="lineCov">          2 :   nopbc(false),</span></a>
<a name="178"><span class="lineNum">     178 </span><span class="lineCov">          4 :   DeltaGValues(&quot;absent&quot;),</span></a>
<a name="179"><span class="lineNum">     179 </span><span class="lineCov">          2 :   Ti(0),</span></a>
<a name="180"><span class="lineNum">     180 </span><span class="lineCov">          2 :   stride(10),</span></a>
<a name="181"><span class="lineNum">     181 </span><span class="lineCov">          2 :   nl_update(0),</span></a>
<a name="182"><span class="lineNum">     182 </span><span class="lineCov">          2 :   firstStepFlag(0)</span></a>
<a name="183"><span class="lineNum">     183 </span>            : {</a>
<a name="184"><span class="lineNum">     184 </span><span class="lineCov">          2 :   rs = 0.14;</span></a>
<a name="185"><span class="lineNum">     185 </span><span class="lineCov">          2 :   parse(&quot;DELTAGFILE&quot;,DeltaGValues);</span></a>
<a name="186"><span class="lineNum">     186 </span><span class="lineCov">          2 :   parse(&quot;APPROACH&quot;, approach);</span></a>
<a name="187"><span class="lineNum">     187 </span><span class="lineCov">          4 :   parseAtomList(&quot;ATOMS&quot;,atoms);</span></a>
<a name="188"><span class="lineNum">     188 </span><span class="lineCov">          2 :   if(atoms.size()==0) error(&quot;no atoms specified&quot;);</span></a>
<a name="189"><span class="lineNum">     189 </span>            :   std::string Type;</a>
<a name="190"><span class="lineNum">     190 </span><span class="lineCov">          2 :   parse(&quot;TYPE&quot;,Type);</span></a>
<a name="191"><span class="lineNum">     191 </span><span class="lineCov">          2 :   parse(&quot;NL_STRIDE&quot;, stride);</span></a>
<a name="192"><span class="lineNum">     192 </span><span class="lineCov">          2 :   parseFlag(&quot;NOPBC&quot;,nopbc);</span></a>
<a name="193"><span class="lineNum">     193 </span><span class="lineCov">          2 :   checkRead();</span></a>
<a name="194"><span class="lineNum">     194 </span>            : </a>
<a name="195"><span class="lineNum">     195 </span><span class="lineCov">          2 :   if(Type==&quot;TOTAL&quot;) sasa_type=TOTAL;</span></a>
<a name="196"><span class="lineNum">     196 </span><span class="lineCov">          1 :   else if(Type==&quot;TRANSFER&quot;) sasa_type=TRANSFER;</span></a>
<a name="197"><span class="lineNum">     197 </span><span class="lineNoCov">          0 :   else error(&quot;Unknown SASA type&quot;);</span></a>
<a name="198"><span class="lineNum">     198 </span>            : </a>
<a name="199"><span class="lineNum">     199 </span><span class="lineCov">          2 :   switch(sasa_type)</span></a>
<a name="200"><span class="lineNum">     200 </span>            :   {</a>
<a name="201"><span class="lineNum">     201 </span><span class="lineCov">          1 :   case TOTAL:   log.printf(&quot;  TOTAL SASA;&quot;); break;</span></a>
<a name="202"><span class="lineNum">     202 </span><span class="lineCov">          1 :   case TRANSFER: log.printf(&quot;  TRANSFER MODEL;&quot;); break;</span></a>
<a name="203"><span class="lineNum">     203 </span>            :   }</a>
<a name="204"><span class="lineNum">     204 </span>            : </a>
<a name="205"><span class="lineNum">     205 </span><span class="lineCov">          2 :   log.printf(&quot;  atoms involved : &quot;);</span></a>
<a name="206"><span class="lineNum">     206 </span><span class="lineCov">        242 :   for(unsigned i=0; i&lt;atoms.size(); ++i) {</span></a>
<a name="207"><span class="lineNum">     207 </span><span class="lineCov">        240 :     if(i%25==0) log&lt;&lt;&quot;\n&quot;;</span></a>
<a name="208"><span class="lineNum">     208 </span><span class="lineCov">        240 :     log.printf(&quot;%d &quot;,atoms[i].serial());</span></a>
<a name="209"><span class="lineNum">     209 </span>            :   }</a>
<a name="210"><span class="lineNum">     210 </span><span class="lineCov">          2 :   log.printf(&quot;\n&quot;);</span></a>
<a name="211"><span class="lineNum">     211 </span>            : </a>
<a name="212"><span class="lineNum">     212 </span><span class="lineCov">          2 :   if(nopbc) {</span></a>
<a name="213"><span class="lineNum">     213 </span><span class="lineNoCov">          0 :     log&lt;&lt;&quot;  PBC will be ignored\n&quot;;</span></a>
<a name="214"><span class="lineNum">     214 </span>            :   } else {</a>
<a name="215"><span class="lineNum">     215 </span><span class="lineCov">          2 :     log&lt;&lt;&quot;  broken molecules will be rebuilt assuming atoms are in the proper order\n&quot;;</span></a>
<a name="216"><span class="lineNum">     216 </span>            :   }</a>
<a name="217"><span class="lineNum">     217 </span>            : </a>
<a name="218"><span class="lineNum">     218 </span>            : </a>
<a name="219"><span class="lineNum">     219 </span><span class="lineCov">          2 :   addValueWithDerivatives(); setNotPeriodic();</span></a>
<a name="220"><span class="lineNum">     220 </span><span class="lineCov">          2 :   requestAtoms(atoms);</span></a>
<a name="221"><span class="lineNum">     221 </span>            : </a>
<a name="222"><span class="lineNum">     222 </span><span class="lineCov">          2 :   natoms = getNumberOfAtoms();</span></a>
<a name="223"><span class="lineNum">     223 </span><span class="lineCov">          2 :   AtomResidueName.resize(2);</span></a>
<a name="224"><span class="lineNum">     224 </span><span class="lineCov">          2 :   LCPOparam.resize(natoms);</span></a>
<a name="225"><span class="lineNum">     225 </span><span class="lineCov">          2 :   MaxSurf.resize(natoms);</span></a>
<a name="226"><span class="lineNum">     226 </span><span class="lineCov">          2 :   DeltaG.resize(natoms+1);</span></a>
<a name="227"><span class="lineNum">     227 </span><span class="lineCov">          2 :   Nlist.resize(natoms);</span></a>
<a name="228"><span class="lineNum">     228 </span>            : </a>
<a name="229"><span class="lineNum">     229 </span>            : </a>
<a name="230"><span class="lineNum">     230 </span><span class="lineCov">          2 : }</span></a>
<a name="231"><span class="lineNum">     231 </span>            : </a>
<a name="232"><span class="lineNum">     232 </span>            : </a>
<a name="233"><span class="lineNum">     233 </span>            : //splits strings into tokens. Used to read into LCPO parameters file and into reference pdb file</a>
<a name="234"><span class="lineNum">     234 </span>            : template &lt;class Container&gt;</a>
<a name="235"><span class="lineNum">     235 </span><span class="lineNoCov">          0 : void split(const std::string&amp; str, Container&amp; cont)</span></a>
<a name="236"><span class="lineNum">     236 </span>            : {</a>
<a name="237"><span class="lineNum">     237 </span><span class="lineNoCov">          0 :   std::istringstream iss(str);</span></a>
<a name="238"><span class="lineNum">     238 </span><span class="lineNoCov">          0 :   std::copy(std::istream_iterator&lt;std::string&gt;(iss),</span></a>
<a name="239"><span class="lineNum">     239 </span><span class="lineNoCov">          0 :             std::istream_iterator&lt;std::string&gt;(),</span></a>
<a name="240"><span class="lineNum">     240 </span>            :             std::back_inserter(cont));</a>
<a name="241"><span class="lineNum">     241 </span><span class="lineNoCov">          0 : }</span></a>
<a name="242"><span class="lineNum">     242 </span>            : </a>
<a name="243"><span class="lineNum">     243 </span>            : </a>
<a name="244"><span class="lineNum">     244 </span>            : //reads input PDB file provided with MOLINFO, and assigns atom and residue names to each atom involved in the CV</a>
<a name="245"><span class="lineNum">     245 </span>            : </a>
<a name="246"><span class="lineNum">     246 </span><span class="lineCov">          2 : void SASA_LCPO::readPDB() {</span></a>
<a name="247"><span class="lineNum">     247 </span><span class="lineCov">          2 :   auto* moldat = plumed.getActionSet().selectLatest&lt;GenericMolInfo*&gt;(this);</span></a>
<a name="248"><span class="lineNum">     248 </span><span class="lineCov">          2 :   if( ! moldat ) error(&quot;Unable to find MOLINFO in input&quot;);</span></a>
<a name="249"><span class="lineNum">     249 </span>            :   AtomResidueName[0].clear();</a>
<a name="250"><span class="lineNum">     250 </span>            :   AtomResidueName[1].clear();</a>
<a name="251"><span class="lineNum">     251 </span>            : </a>
<a name="252"><span class="lineNum">     252 </span><span class="lineCov">        242 :   for(unsigned i=0; i&lt;natoms; i++) {</span></a>
<a name="253"><span class="lineNum">     253 </span><span class="lineCov">        240 :     string Aname = moldat-&gt;getAtomName(atoms[i]);</span></a>
<a name="254"><span class="lineNum">     254 </span><span class="lineCov">        240 :     string Rname = moldat-&gt;getResidueName(atoms[i]);</span></a>
<a name="255"><span class="lineNum">     255 </span><span class="lineCov">        240 :     AtomResidueName[0].push_back (Aname);</span></a>
<a name="256"><span class="lineNum">     256 </span><span class="lineCov">        240 :     AtomResidueName[1].push_back (Rname);</span></a>
<a name="257"><span class="lineNum">     257 </span>            :   }</a>
<a name="258"><span class="lineNum">     258 </span>            : </a>
<a name="259"><span class="lineNum">     259 </span><span class="lineCov">          2 : }</span></a>
<a name="260"><span class="lineNum">     260 </span>            : </a>
<a name="261"><span class="lineNum">     261 </span>            : //LCPO parameters database</a>
<a name="262"><span class="lineNum">     262 </span><span class="lineCov">          2 : map&lt;string, vector&lt;double&gt; &gt; SASA_LCPO::setupLCPOparam() {</span></a>
<a name="263"><span class="lineNum">     263 </span>            :   map&lt;string, vector&lt;double&gt; &gt; lcpomap;</a>
<a name="264"><span class="lineNum">     264 </span><span class="lineCov">          2 :   lcpomap[&quot;ALA_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="265"><span class="lineNum">     265 </span><span class="lineCov">          2 :   lcpomap[&quot;ALA_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="266"><span class="lineNum">     266 </span><span class="lineCov">          2 :   lcpomap[&quot;ALA_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="267"><span class="lineNum">     267 </span><span class="lineCov">          2 :   lcpomap[&quot;ALA_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="268"><span class="lineNum">     268 </span><span class="lineCov">          2 :   lcpomap[&quot;ALA_CB&quot;] = { 1.7,  0.77887,  -0.28063,  -0.0012968,  0.00039328};</span></a>
<a name="269"><span class="lineNum">     269 </span><span class="lineCov">          2 :   lcpomap[&quot;ASP_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="270"><span class="lineNum">     270 </span><span class="lineCov">          2 :   lcpomap[&quot;ASP_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="271"><span class="lineNum">     271 </span><span class="lineCov">          2 :   lcpomap[&quot;ASP_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="272"><span class="lineNum">     272 </span><span class="lineCov">          2 :   lcpomap[&quot;ASP_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="273"><span class="lineNum">     273 </span><span class="lineCov">          2 :   lcpomap[&quot;ASP_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="274"><span class="lineNum">     274 </span><span class="lineCov">          2 :   lcpomap[&quot;ASP_CG&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="275"><span class="lineNum">     275 </span><span class="lineCov">          2 :   lcpomap[&quot;ASP_OD1&quot;] = { 1.6,  0.77914,  -0.25262,  -0.0016056,  0.00035071};</span></a>
<a name="276"><span class="lineNum">     276 </span><span class="lineCov">          2 :   lcpomap[&quot;ASP_OD2&quot;] = { 1.6,  0.77914,  -0.25262,  -0.0016056,  0.00035071};</span></a>
<a name="277"><span class="lineNum">     277 </span><span class="lineCov">          2 :   lcpomap[&quot;ASN_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="278"><span class="lineNum">     278 </span><span class="lineCov">          2 :   lcpomap[&quot;ASN_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="279"><span class="lineNum">     279 </span><span class="lineCov">          2 :   lcpomap[&quot;ASN_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="280"><span class="lineNum">     280 </span><span class="lineCov">          2 :   lcpomap[&quot;ASN_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="281"><span class="lineNum">     281 </span><span class="lineCov">          2 :   lcpomap[&quot;ASN_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="282"><span class="lineNum">     282 </span><span class="lineCov">          2 :   lcpomap[&quot;ASN_CG&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="283"><span class="lineNum">     283 </span><span class="lineCov">          2 :   lcpomap[&quot;ASN_OD1&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="284"><span class="lineNum">     284 </span><span class="lineCov">          2 :   lcpomap[&quot;ASN_ND2&quot;] = { 1.65,  0.73511,  -0.22116,  -0.00089148,  0.0002523};</span></a>
<a name="285"><span class="lineNum">     285 </span><span class="lineCov">          2 :   lcpomap[&quot;ARG_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="286"><span class="lineNum">     286 </span><span class="lineCov">          2 :   lcpomap[&quot;ARG_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="287"><span class="lineNum">     287 </span><span class="lineCov">          2 :   lcpomap[&quot;ARG_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="288"><span class="lineNum">     288 </span><span class="lineCov">          2 :   lcpomap[&quot;ARG_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="289"><span class="lineNum">     289 </span><span class="lineCov">          2 :   lcpomap[&quot;ARG_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="290"><span class="lineNum">     290 </span><span class="lineCov">          2 :   lcpomap[&quot;ARG_CG&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="291"><span class="lineNum">     291 </span><span class="lineCov">          2 :   lcpomap[&quot;ARG_CD&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="292"><span class="lineNum">     292 </span><span class="lineCov">          2 :   lcpomap[&quot;ARG_NE&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="293"><span class="lineNum">     293 </span><span class="lineCov">          2 :   lcpomap[&quot;ARG_NH1&quot;] = { 1.65,  0.73511,  -0.22116,  -0.00089148,  0.0002523};</span></a>
<a name="294"><span class="lineNum">     294 </span><span class="lineCov">          2 :   lcpomap[&quot;ARG_NH2&quot;] = { 1.65,  0.73511,  -0.22116,  -0.00089148,  0.0002523};</span></a>
<a name="295"><span class="lineNum">     295 </span><span class="lineCov">          2 :   lcpomap[&quot;ARG_CZ&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="296"><span class="lineNum">     296 </span><span class="lineCov">          2 :   lcpomap[&quot;CYS_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="297"><span class="lineNum">     297 </span><span class="lineCov">          2 :   lcpomap[&quot;CYS_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="298"><span class="lineNum">     298 </span><span class="lineCov">          2 :   lcpomap[&quot;CYS_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="299"><span class="lineNum">     299 </span><span class="lineCov">          2 :   lcpomap[&quot;CYS_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="300"><span class="lineNum">     300 </span><span class="lineCov">          2 :   lcpomap[&quot;CYS_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="301"><span class="lineNum">     301 </span><span class="lineCov">          2 :   lcpomap[&quot;CYS_SG&quot;] = { 1.9,  0.54581,  -0.19477,  -0.0012873,  0.00029247};</span></a>
<a name="302"><span class="lineNum">     302 </span><span class="lineCov">          2 :   lcpomap[&quot;GLU_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="303"><span class="lineNum">     303 </span><span class="lineCov">          2 :   lcpomap[&quot;GLU_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="304"><span class="lineNum">     304 </span><span class="lineCov">          2 :   lcpomap[&quot;GLU_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="305"><span class="lineNum">     305 </span><span class="lineCov">          2 :   lcpomap[&quot;GLU_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="306"><span class="lineNum">     306 </span><span class="lineCov">          2 :   lcpomap[&quot;GLU_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="307"><span class="lineNum">     307 </span><span class="lineCov">          2 :   lcpomap[&quot;GLU_CG&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="308"><span class="lineNum">     308 </span><span class="lineCov">          2 :   lcpomap[&quot;GLU_CD&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="309"><span class="lineNum">     309 </span><span class="lineCov">          2 :   lcpomap[&quot;GLU_OE1&quot;] = { 1.6,  0.77914,  -0.25262,  -0.0016056,  0.00035071};</span></a>
<a name="310"><span class="lineNum">     310 </span><span class="lineCov">          2 :   lcpomap[&quot;GLU_OE2&quot;] = { 1.6,  0.77914,  -0.25262,  -0.0016056,  0.00035071};</span></a>
<a name="311"><span class="lineNum">     311 </span><span class="lineCov">          2 :   lcpomap[&quot;GLN_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="312"><span class="lineNum">     312 </span><span class="lineCov">          2 :   lcpomap[&quot;GLN_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="313"><span class="lineNum">     313 </span><span class="lineCov">          2 :   lcpomap[&quot;GLN_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="314"><span class="lineNum">     314 </span><span class="lineCov">          2 :   lcpomap[&quot;GLN_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="315"><span class="lineNum">     315 </span><span class="lineCov">          2 :   lcpomap[&quot;GLN_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="316"><span class="lineNum">     316 </span><span class="lineCov">          2 :   lcpomap[&quot;GLN_CG&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="317"><span class="lineNum">     317 </span><span class="lineCov">          2 :   lcpomap[&quot;GLN_CD&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="318"><span class="lineNum">     318 </span><span class="lineCov">          2 :   lcpomap[&quot;GLN_OE1&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="319"><span class="lineNum">     319 </span><span class="lineCov">          2 :   lcpomap[&quot;GLN_NE2&quot;] = { 1.65,  0.73511,  -0.22116,  -0.00089148,  0.0002523};</span></a>
<a name="320"><span class="lineNum">     320 </span><span class="lineCov">          2 :   lcpomap[&quot;GLY_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="321"><span class="lineNum">     321 </span><span class="lineCov">          2 :   lcpomap[&quot;GLY_CA&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="322"><span class="lineNum">     322 </span><span class="lineCov">          2 :   lcpomap[&quot;GLY_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="323"><span class="lineNum">     323 </span><span class="lineCov">          2 :   lcpomap[&quot;GLY_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="324"><span class="lineNum">     324 </span><span class="lineCov">          2 :   lcpomap[&quot;HIS_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="325"><span class="lineNum">     325 </span><span class="lineCov">          2 :   lcpomap[&quot;HIS_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="326"><span class="lineNum">     326 </span><span class="lineCov">          2 :   lcpomap[&quot;HIS_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="327"><span class="lineNum">     327 </span><span class="lineCov">          2 :   lcpomap[&quot;HIS_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="328"><span class="lineNum">     328 </span><span class="lineCov">          2 :   lcpomap[&quot;HIS_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="329"><span class="lineNum">     329 </span><span class="lineCov">          2 :   lcpomap[&quot;HIS_CG&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="330"><span class="lineNum">     330 </span><span class="lineCov">          2 :   lcpomap[&quot;HIS_ND1&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="331"><span class="lineNum">     331 </span><span class="lineCov">          2 :   lcpomap[&quot;HIS_CE1&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="332"><span class="lineNum">     332 </span><span class="lineCov">          2 :   lcpomap[&quot;HIS_NE2&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="333"><span class="lineNum">     333 </span><span class="lineCov">          2 :   lcpomap[&quot;HIS_CD2&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="334"><span class="lineNum">     334 </span><span class="lineCov">          2 :   lcpomap[&quot;ILE_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="335"><span class="lineNum">     335 </span><span class="lineCov">          2 :   lcpomap[&quot;ILE_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="336"><span class="lineNum">     336 </span><span class="lineCov">          2 :   lcpomap[&quot;ILE_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="337"><span class="lineNum">     337 </span><span class="lineCov">          2 :   lcpomap[&quot;ILE_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="338"><span class="lineNum">     338 </span><span class="lineCov">          2 :   lcpomap[&quot;ILE_CB&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="339"><span class="lineNum">     339 </span><span class="lineCov">          2 :   lcpomap[&quot;ILE_CG2&quot;] = { 1.7,  0.77887,  -0.28063,  -0.0012968,  0.00039328};</span></a>
<a name="340"><span class="lineNum">     340 </span><span class="lineCov">          2 :   lcpomap[&quot;ILE_CG1&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="341"><span class="lineNum">     341 </span><span class="lineCov">          2 :   lcpomap[&quot;ILE_CD1&quot;] = { 1.7,  0.77887,  -0.28063,  -0.0012968,  0.00039328};</span></a>
<a name="342"><span class="lineNum">     342 </span><span class="lineCov">          2 :   lcpomap[&quot;LEU_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="343"><span class="lineNum">     343 </span><span class="lineCov">          2 :   lcpomap[&quot;LEU_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="344"><span class="lineNum">     344 </span><span class="lineCov">          2 :   lcpomap[&quot;LEU_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="345"><span class="lineNum">     345 </span><span class="lineCov">          2 :   lcpomap[&quot;LEU_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="346"><span class="lineNum">     346 </span><span class="lineCov">          2 :   lcpomap[&quot;LEU_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="347"><span class="lineNum">     347 </span><span class="lineCov">          2 :   lcpomap[&quot;LEU_CG&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="348"><span class="lineNum">     348 </span><span class="lineCov">          2 :   lcpomap[&quot;LEU_CD1&quot;] = { 1.7,  0.77887,  -0.28063,  -0.0012968,  0.00039328};</span></a>
<a name="349"><span class="lineNum">     349 </span><span class="lineCov">          2 :   lcpomap[&quot;LEU_CD2&quot;] = { 1.7,  0.77887,  -0.28063,  -0.0012968,  0.00039328};</span></a>
<a name="350"><span class="lineNum">     350 </span><span class="lineCov">          2 :   lcpomap[&quot;LYS_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="351"><span class="lineNum">     351 </span><span class="lineCov">          2 :   lcpomap[&quot;LYS_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="352"><span class="lineNum">     352 </span><span class="lineCov">          2 :   lcpomap[&quot;LYS_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="353"><span class="lineNum">     353 </span><span class="lineCov">          2 :   lcpomap[&quot;LYS_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="354"><span class="lineNum">     354 </span><span class="lineCov">          2 :   lcpomap[&quot;LYS_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="355"><span class="lineNum">     355 </span><span class="lineCov">          2 :   lcpomap[&quot;LYS_CG&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="356"><span class="lineNum">     356 </span><span class="lineCov">          2 :   lcpomap[&quot;LYS_CD&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="357"><span class="lineNum">     357 </span><span class="lineCov">          2 :   lcpomap[&quot;LYS_CE&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="358"><span class="lineNum">     358 </span><span class="lineCov">          2 :   lcpomap[&quot;LYS_NZ&quot;] = { 1.65,  0.73511,  -0.22116,  -0.00089148,  0.0002523};</span></a>
<a name="359"><span class="lineNum">     359 </span><span class="lineCov">          2 :   lcpomap[&quot;MET_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="360"><span class="lineNum">     360 </span><span class="lineCov">          2 :   lcpomap[&quot;MET_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="361"><span class="lineNum">     361 </span><span class="lineCov">          2 :   lcpomap[&quot;MET_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="362"><span class="lineNum">     362 </span><span class="lineCov">          2 :   lcpomap[&quot;MET_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="363"><span class="lineNum">     363 </span><span class="lineCov">          2 :   lcpomap[&quot;MET_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="364"><span class="lineNum">     364 </span><span class="lineCov">          2 :   lcpomap[&quot;MET_CG&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="365"><span class="lineNum">     365 </span><span class="lineCov">          2 :   lcpomap[&quot;MET_SD&quot;] = { 1.9,  0.54581,  -0.19477,  -0.0012873,  0.00029247};</span></a>
<a name="366"><span class="lineNum">     366 </span><span class="lineCov">          2 :   lcpomap[&quot;MET_CE&quot;] = { 1.7,  0.77887,  -0.28063,  -0.0012968,  0.00039328};</span></a>
<a name="367"><span class="lineNum">     367 </span><span class="lineCov">          2 :   lcpomap[&quot;PHE_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="368"><span class="lineNum">     368 </span><span class="lineCov">          2 :   lcpomap[&quot;PHE_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="369"><span class="lineNum">     369 </span><span class="lineCov">          2 :   lcpomap[&quot;PHE_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="370"><span class="lineNum">     370 </span><span class="lineCov">          2 :   lcpomap[&quot;PHE_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="371"><span class="lineNum">     371 </span><span class="lineCov">          2 :   lcpomap[&quot;PHE_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="372"><span class="lineNum">     372 </span><span class="lineCov">          2 :   lcpomap[&quot;PHE_CG&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="373"><span class="lineNum">     373 </span><span class="lineCov">          2 :   lcpomap[&quot;PHE_CD1&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="374"><span class="lineNum">     374 </span><span class="lineCov">          2 :   lcpomap[&quot;PHE_CE1&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="375"><span class="lineNum">     375 </span><span class="lineCov">          2 :   lcpomap[&quot;PHE_CZ&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="376"><span class="lineNum">     376 </span><span class="lineCov">          2 :   lcpomap[&quot;PHE_CE2&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="377"><span class="lineNum">     377 </span><span class="lineCov">          2 :   lcpomap[&quot;PHE_CD2&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="378"><span class="lineNum">     378 </span><span class="lineCov">          2 :   lcpomap[&quot;PRO_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="379"><span class="lineNum">     379 </span><span class="lineCov">          2 :   lcpomap[&quot;PRO_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="380"><span class="lineNum">     380 </span><span class="lineCov">          2 :   lcpomap[&quot;PRO_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="381"><span class="lineNum">     381 </span><span class="lineCov">          2 :   lcpomap[&quot;PRO_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="382"><span class="lineNum">     382 </span><span class="lineCov">          2 :   lcpomap[&quot;PRO_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="383"><span class="lineNum">     383 </span><span class="lineCov">          2 :   lcpomap[&quot;PRO_CG&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="384"><span class="lineNum">     384 </span><span class="lineCov">          2 :   lcpomap[&quot;PRO_CD&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="385"><span class="lineNum">     385 </span><span class="lineCov">          2 :   lcpomap[&quot;SER_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="386"><span class="lineNum">     386 </span><span class="lineCov">          2 :   lcpomap[&quot;SER_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="387"><span class="lineNum">     387 </span><span class="lineCov">          2 :   lcpomap[&quot;SER_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="388"><span class="lineNum">     388 </span><span class="lineCov">          2 :   lcpomap[&quot;SER_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="389"><span class="lineNum">     389 </span><span class="lineCov">          2 :   lcpomap[&quot;SER_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="390"><span class="lineNum">     390 </span><span class="lineCov">          2 :   lcpomap[&quot;SER_OG&quot;] = { 1.6,  0.77914,  -0.25262,  -0.0016056,  0.00035071};</span></a>
<a name="391"><span class="lineNum">     391 </span><span class="lineCov">          2 :   lcpomap[&quot;THR_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="392"><span class="lineNum">     392 </span><span class="lineCov">          2 :   lcpomap[&quot;THR_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="393"><span class="lineNum">     393 </span><span class="lineCov">          2 :   lcpomap[&quot;THR_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="394"><span class="lineNum">     394 </span><span class="lineCov">          2 :   lcpomap[&quot;THR_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="395"><span class="lineNum">     395 </span><span class="lineCov">          2 :   lcpomap[&quot;THR_CB&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="396"><span class="lineNum">     396 </span><span class="lineCov">          2 :   lcpomap[&quot;THR_CG2&quot;] = { 1.7,  0.77887,  -0.28063,  -0.0012968,  0.00039328};</span></a>
<a name="397"><span class="lineNum">     397 </span><span class="lineCov">          2 :   lcpomap[&quot;THR_OG1&quot;] = { 1.6,  0.77914,  -0.25262,  -0.0016056,  0.00035071};</span></a>
<a name="398"><span class="lineNum">     398 </span><span class="lineCov">          2 :   lcpomap[&quot;TRP_N&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="399"><span class="lineNum">     399 </span><span class="lineCov">          2 :   lcpomap[&quot;TRP_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="400"><span class="lineNum">     400 </span><span class="lineCov">          2 :   lcpomap[&quot;TRP_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="401"><span class="lineNum">     401 </span><span class="lineCov">          2 :   lcpomap[&quot;TRP_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="402"><span class="lineNum">     402 </span><span class="lineCov">          2 :   lcpomap[&quot;TRP_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="403"><span class="lineNum">     403 </span><span class="lineCov">          2 :   lcpomap[&quot;TRP_CG&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="404"><span class="lineNum">     404 </span><span class="lineCov">          2 :   lcpomap[&quot;TRP_CD1&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="405"><span class="lineNum">     405 </span><span class="lineCov">          2 :   lcpomap[&quot;TRP_NE1&quot;] = { 1.65,  0.41102,  -0.12254,  -7.5448e-05,  0.00011804};</span></a>
<a name="406"><span class="lineNum">     406 </span><span class="lineCov">          2 :   lcpomap[&quot;TRP_CE2&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="407"><span class="lineNum">     407 </span><span class="lineCov">          2 :   lcpomap[&quot;TRP_CZ2&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="408"><span class="lineNum">     408 </span><span class="lineCov">          2 :   lcpomap[&quot;TRP_CH2&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="409"><span class="lineNum">     409 </span><span class="lineCov">          2 :   lcpomap[&quot;TRP_CZ3&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="410"><span class="lineNum">     410 </span><span class="lineCov">          2 :   lcpomap[&quot;TRP_CE3&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="411"><span class="lineNum">     411 </span><span class="lineCov">          2 :   lcpomap[&quot;TRP_CD2&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="412"><span class="lineNum">     412 </span><span class="lineCov">          2 :   lcpomap[&quot;TYR_N&quot;] = { 1.65,  0.062577,  -0.017874,  -8.312e-05,  1.9849e-05};</span></a>
<a name="413"><span class="lineNum">     413 </span><span class="lineCov">          2 :   lcpomap[&quot;TYR_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="414"><span class="lineNum">     414 </span><span class="lineCov">          2 :   lcpomap[&quot;TYR_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="415"><span class="lineNum">     415 </span><span class="lineCov">          2 :   lcpomap[&quot;TYR_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="416"><span class="lineNum">     416 </span><span class="lineCov">          2 :   lcpomap[&quot;TYR_CB&quot;] = { 1.7,  0.56482,  -0.19608,  -0.0010219,  0.0002658};</span></a>
<a name="417"><span class="lineNum">     417 </span><span class="lineCov">          2 :   lcpomap[&quot;TYR_CG&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="418"><span class="lineNum">     418 </span><span class="lineCov">          2 :   lcpomap[&quot;TYR_CD1&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="419"><span class="lineNum">     419 </span><span class="lineCov">          2 :   lcpomap[&quot;TYR_CE1&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="420"><span class="lineNum">     420 </span><span class="lineCov">          2 :   lcpomap[&quot;TYR_CZ&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="421"><span class="lineNum">     421 </span><span class="lineCov">          2 :   lcpomap[&quot;TYR_OH&quot;] = { 1.6,  0.77914,  -0.25262,  -0.0016056,  0.00035071};</span></a>
<a name="422"><span class="lineNum">     422 </span><span class="lineCov">          2 :   lcpomap[&quot;TYR_CE2&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="423"><span class="lineNum">     423 </span><span class="lineCov">          2 :   lcpomap[&quot;TYR_CD2&quot;] = { 1.7,  0.51245,  -0.15966,  -0.00019781,  0.00016392};</span></a>
<a name="424"><span class="lineNum">     424 </span><span class="lineCov">          2 :   lcpomap[&quot;VAL_N&quot;] = { 1.65,  0.062577,  -0.017874,  -8.312e-05,  1.9849e-05};</span></a>
<a name="425"><span class="lineNum">     425 </span><span class="lineCov">          2 :   lcpomap[&quot;VAL_CA&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="426"><span class="lineNum">     426 </span><span class="lineCov">          2 :   lcpomap[&quot;VAL_C&quot;] = { 1.7,  0.070344,  -0.019015,  -2.2009e-05,  1.6875e-05};</span></a>
<a name="427"><span class="lineNum">     427 </span><span class="lineCov">          2 :   lcpomap[&quot;VAL_O&quot;] = { 1.6,  0.68563,  -0.1868,  -0.00135573,  0.00023743};</span></a>
<a name="428"><span class="lineNum">     428 </span><span class="lineCov">          2 :   lcpomap[&quot;VAL_CB&quot;] = { 1.7,  0.23348,  -0.072627,  -0.00020079,  7.967e-05};</span></a>
<a name="429"><span class="lineNum">     429 </span><span class="lineCov">          2 :   lcpomap[&quot;VAL_CG1&quot;] = { 1.7,  0.77887,  -0.28063,  -0.0012968,  0.00039328};</span></a>
<a name="430"><span class="lineNum">     430 </span><span class="lineCov">          2 :   lcpomap[&quot;VAL_CG2&quot;] = { 1.7,  0.77887,  -0.28063,  -0.0012968,  0.00039328};</span></a>
<a name="431"><span class="lineNum">     431 </span><span class="lineCov">          2 :   return lcpomap;</span></a>
<a name="432"><span class="lineNum">     432 </span>            : }</a>
<a name="433"><span class="lineNum">     433 </span>            : </a>
<a name="434"><span class="lineNum">     434 </span>            : //assigns LCPO parameters to each atom reading from database</a>
<a name="435"><span class="lineNum">     435 </span><span class="lineCov">          2 : void SASA_LCPO::readLCPOparam() {</span></a>
<a name="436"><span class="lineNum">     436 </span>            : </a>
<a name="437"><span class="lineNum">     437 </span><span class="lineCov">        242 :   for(unsigned i=0; i&lt;natoms; i++) {</span></a>
<a name="438"><span class="lineNum">     438 </span><span class="lineCov">        240 :     LCPOparam[i].clear();</span></a>
<a name="439"><span class="lineNum">     439 </span>            :   }</a>
<a name="440"><span class="lineNum">     440 </span>            : </a>
<a name="441"><span class="lineNum">     441 </span>            :   map&lt;string, vector&lt;double&gt; &gt; lcpomap;</a>
<a name="442"><span class="lineNum">     442 </span><span class="lineCov">          4 :   lcpomap = setupLCPOparam();</span></a>
<a name="443"><span class="lineNum">     443 </span>            :   vector&lt;double&gt; LCPOparamVector;</a>
<a name="444"><span class="lineNum">     444 </span>            :   string identifier;</a>
<a name="445"><span class="lineNum">     445 </span><span class="lineCov">        242 :   for(unsigned i=0; i&lt;natoms; i++) {</span></a>
<a name="446"><span class="lineNum">     446 </span><span class="lineCov">        240 :     if ((AtomResidueName[0][i][0]=='O') || (AtomResidueName[0][i][0]=='N') || (AtomResidueName[0][i][0]=='C') || (AtomResidueName[0][i][0]=='S')) {</span></a>
<a name="447"><span class="lineNum">     447 </span><span class="lineCov">        240 :       identifier = AtomResidueName[1][i]+&quot;_&quot;+AtomResidueName[0][i];</span></a>
<a name="448"><span class="lineNum">     448 </span><span class="lineCov">        120 :       LCPOparamVector = lcpomap.at(identifier);</span></a>
<a name="449"><span class="lineNum">     449 </span><span class="lineCov">        120 :       LCPOparam[i].push_back (LCPOparamVector[0]+rs*10);</span></a>
<a name="450"><span class="lineNum">     450 </span><span class="lineCov">        120 :       LCPOparam[i].push_back (LCPOparamVector[1]);</span></a>
<a name="451"><span class="lineNum">     451 </span><span class="lineCov">        120 :       LCPOparam[i].push_back (LCPOparamVector[2]);</span></a>
<a name="452"><span class="lineNum">     452 </span><span class="lineCov">        120 :       LCPOparam[i].push_back (LCPOparamVector[3]);</span></a>
<a name="453"><span class="lineNum">     453 </span><span class="lineCov">        120 :       LCPOparam[i].push_back (LCPOparamVector[4]);</span></a>
<a name="454"><span class="lineNum">     454 </span>            :     }</a>
<a name="455"><span class="lineNum">     455 </span>            :   }</a>
<a name="456"><span class="lineNum">     456 </span>            : </a>
<a name="457"><span class="lineNum">     457 </span>            : </a>
<a name="458"><span class="lineNum">     458 </span><span class="lineCov">        242 :   for(unsigned i=0; i&lt;natoms; i++) {</span></a>
<a name="459"><span class="lineNum">     459 </span><span class="lineCov">        240 :     if (LCPOparam[i].size()==0 ) {</span></a>
<a name="460"><span class="lineNum">     460 </span><span class="lineCov">        120 :       if ((AtomResidueName[0][i][0]=='O') || (AtomResidueName[0][i][0]=='N') || (AtomResidueName[0][i][0]=='C') || (AtomResidueName[0][i][0]=='S')) {</span></a>
<a name="461"><span class="lineNum">     461 </span><span class="lineNoCov">          0 :         cout &lt;&lt; &quot;Could not find LCPO paramaters for atom &quot; &lt;&lt; AtomResidueName[0][i] &lt;&lt; &quot; of residue &quot; &lt;&lt; AtomResidueName[1][i] &lt;&lt; endl;</span></a>
<a name="462"><span class="lineNum">     462 </span><span class="lineNoCov">          0 :         error (&quot;missing LCPO parameters\n&quot;);</span></a>
<a name="463"><span class="lineNum">     463 </span>            :       }</a>
<a name="464"><span class="lineNum">     464 </span>            :     }</a>
<a name="465"><span class="lineNum">     465 </span>            :   }</a>
<a name="466"><span class="lineNum">     466 </span>            : </a>
<a name="467"><span class="lineNum">     467 </span><span class="lineCov">          2 :   if (AtomResidueName[0][0] == &quot;N&quot;) {</span></a>
<a name="468"><span class="lineNum">     468 </span><span class="lineCov">          2 :     LCPOparam[0][1] = 7.3511e-01;</span></a>
<a name="469"><span class="lineNum">     469 </span><span class="lineCov">          2 :     LCPOparam[0][2] = -2.2116e-01;</span></a>
<a name="470"><span class="lineNum">     470 </span><span class="lineCov">          2 :     LCPOparam[0][3] = -8.9148e-04;</span></a>
<a name="471"><span class="lineNum">     471 </span><span class="lineCov">          2 :     LCPOparam[0][4] = 2.5230e-04;</span></a>
<a name="472"><span class="lineNum">     472 </span>            :   }</a>
<a name="473"><span class="lineNum">     473 </span>            : </a>
<a name="474"><span class="lineNum">     474 </span><span class="lineCov">          2 :   if (AtomResidueName[0][natoms-1] == &quot;O&quot;) {</span></a>
<a name="475"><span class="lineNum">     475 </span><span class="lineCov">          2 :     LCPOparam[natoms-1][1] = 8.8857e-01;</span></a>
<a name="476"><span class="lineNum">     476 </span><span class="lineCov">          2 :     LCPOparam[natoms-1][2] = -3.3421e-01;</span></a>
<a name="477"><span class="lineNum">     477 </span><span class="lineCov">          2 :     LCPOparam[natoms-1][3] = -1.8683e-03;</span></a>
<a name="478"><span class="lineNum">     478 </span><span class="lineCov">          2 :     LCPOparam[natoms-1][4] = 4.9372e-04;</span></a>
<a name="479"><span class="lineNum">     479 </span>            :   }</a>
<a name="480"><span class="lineNum">     480 </span><span class="lineCov">          2 : }</span></a>
<a name="481"><span class="lineNum">     481 </span>            : </a>
<a name="482"><span class="lineNum">     482 </span>            : </a>
<a name="483"><span class="lineNum">     483 </span>            : //Max Surf values, used only if TYPE=TRANSFER</a>
<a name="484"><span class="lineNum">     484 </span><span class="lineCov">          1 : map&lt;string, vector&lt;double&gt; &gt; SASA_LCPO::setupMaxSurfMap() {</span></a>
<a name="485"><span class="lineNum">     485 </span>            :   // Max Surface Area for backbone and sidechain, in nm2</a>
<a name="486"><span class="lineNum">     486 </span>            :   map&lt;string, vector&lt;double&gt; &gt; valuemap;</a>
<a name="487"><span class="lineNum">     487 </span><span class="lineCov">          1 :   valuemap [&quot;ALA&quot;]= {0.671446,0.420263,};</span></a>
<a name="488"><span class="lineNum">     488 </span><span class="lineCov">          1 :   valuemap [&quot;ARG&quot;]= {0.578582,1.95454,};</span></a>
<a name="489"><span class="lineNum">     489 </span><span class="lineCov">          1 :   valuemap [&quot;ASN&quot;]= {0.559411,1.07102,};</span></a>
<a name="490"><span class="lineNum">     490 </span><span class="lineCov">          1 :   valuemap [&quot;ASP&quot;]= {0.558363,1.03971,};</span></a>
<a name="491"><span class="lineNum">     491 </span><span class="lineCov">          1 :   valuemap [&quot;CYS&quot;]= {0.609271,0.657612,};</span></a>
<a name="492"><span class="lineNum">     492 </span><span class="lineCov">          1 :   valuemap [&quot;GLN&quot;]= {0.565651,1.433031,};</span></a>
<a name="493"><span class="lineNum">     493 </span><span class="lineCov">          1 :   valuemap [&quot;GLU&quot;]= {0.572399,1.41848,};</span></a>
<a name="494"><span class="lineNum">     494 </span><span class="lineCov">          1 :   valuemap [&quot;GLY&quot;]= {0.861439,0,};</span></a>
<a name="495"><span class="lineNum">     495 </span><span class="lineCov">          1 :   valuemap [&quot;HIS&quot;]= {0.559929,1.143827,};</span></a>
<a name="496"><span class="lineNum">     496 </span><span class="lineCov">          1 :   valuemap [&quot;ILE&quot;]= {0.553491,1.25334,};</span></a>
<a name="497"><span class="lineNum">     497 </span><span class="lineCov">          1 :   valuemap [&quot;LEU&quot;]= {0.570103,1.260459,};</span></a>
<a name="498"><span class="lineNum">     498 </span><span class="lineCov">          1 :   valuemap [&quot;LYS&quot;]= {0.580304,1.687487,};</span></a>
<a name="499"><span class="lineNum">     499 </span><span class="lineCov">          1 :   valuemap [&quot;MET&quot;]= {0.5856,1.498954,};</span></a>
<a name="500"><span class="lineNum">     500 </span><span class="lineCov">          1 :   valuemap [&quot;PHE&quot;]= {0.54155,1.394861,};</span></a>
<a name="501"><span class="lineNum">     501 </span><span class="lineCov">          1 :   valuemap [&quot;PRO&quot;]= {0.456048,0.849461,};</span></a>
<a name="502"><span class="lineNum">     502 </span><span class="lineCov">          1 :   valuemap [&quot;SER&quot;]= {0.59074,0.714538,};</span></a>
<a name="503"><span class="lineNum">     503 </span><span class="lineCov">          1 :   valuemap [&quot;THR&quot;]= {0.559116,0.951644,};</span></a>
<a name="504"><span class="lineNum">     504 </span><span class="lineCov">          1 :   valuemap [&quot;TRP&quot;]= {0.55536,1.59324,};</span></a>
<a name="505"><span class="lineNum">     505 </span><span class="lineCov">          1 :   valuemap [&quot;TYR&quot;]= {0.451171,1.566918,};</span></a>
<a name="506"><span class="lineNum">     506 </span><span class="lineCov">          1 :   valuemap [&quot;VAL&quot;]= {0.454809,0.928685,};</span></a>
<a name="507"><span class="lineNum">     507 </span><span class="lineCov">          1 :   return valuemap;</span></a>
<a name="508"><span class="lineNum">     508 </span>            : }</a>
<a name="509"><span class="lineNum">     509 </span>            : </a>
<a name="510"><span class="lineNum">     510 </span>            : </a>
<a name="511"><span class="lineNum">     511 </span>            : </a>
<a name="512"><span class="lineNum">     512 </span>            : //reads maximum surface values per residue type and assigns values to each atom, only used if sasa_type = TRANSFER</a>
<a name="513"><span class="lineNum">     513 </span>            : </a>
<a name="514"><span class="lineNum">     514 </span><span class="lineCov">          1 : void SASA_LCPO::readMaxSurf() {</span></a>
<a name="515"><span class="lineNum">     515 </span>            :   map&lt;string, vector&lt;double&gt; &gt; valuemap;</a>
<a name="516"><span class="lineNum">     516 </span><span class="lineCov">          2 :   valuemap = setupMaxSurfMap();</span></a>
<a name="517"><span class="lineNum">     517 </span>            :   vector&lt;double&gt; MaxSurfVector;</a>
<a name="518"><span class="lineNum">     518 </span>            : </a>
<a name="519"><span class="lineNum">     519 </span><span class="lineCov">        121 :   for(unsigned i=0; i&lt;natoms; i++) {</span></a>
<a name="520"><span class="lineNum">     520 </span><span class="lineCov">        120 :     MaxSurf[i].clear();</span></a>
<a name="521"><span class="lineNum">     521 </span><span class="lineCov">        120 :     MaxSurfVector = valuemap.at(AtomResidueName[1][i]);</span></a>
<a name="522"><span class="lineNum">     522 </span><span class="lineCov">        120 :     MaxSurf[i].push_back (MaxSurfVector[0]*100);</span></a>
<a name="523"><span class="lineNum">     523 </span><span class="lineCov">        120 :     MaxSurf[i].push_back (MaxSurfVector[1]*100);</span></a>
<a name="524"><span class="lineNum">     524 </span>            :   }</a>
<a name="525"><span class="lineNum">     525 </span><span class="lineCov">          1 : }</span></a>
<a name="526"><span class="lineNum">     526 </span>            : </a>
<a name="527"><span class="lineNum">     527 </span>            : //reads file with free energy values for sidechains and for the backbone, and assigns values to each atom. Only used if sasa_type = TRANSFER</a>
<a name="528"><span class="lineNum">     528 </span>            : </a>
<a name="529"><span class="lineNum">     529 </span><span class="lineCov">          1 : void SASA_LCPO::readDeltaG() {</span></a>
<a name="530"><span class="lineNum">     530 </span>            : </a>
<a name="531"><span class="lineNum">     531 </span><span class="lineCov">        121 :   for(unsigned i=0; i&lt;natoms; i++) {</span></a>
<a name="532"><span class="lineNum">     532 </span><span class="lineCov">        120 :     DeltaG[i].clear();</span></a>
<a name="533"><span class="lineNum">     533 </span>            :   }</a>
<a name="534"><span class="lineNum">     534 </span>            : </a>
<a name="535"><span class="lineNum">     535 </span>            :   string DeltaGline;</a>
<a name="536"><span class="lineNum">     536 </span><span class="lineCov">          1 :   fstream DeltaGFile;</span></a>
<a name="537"><span class="lineNum">     537 </span><span class="lineCov">          1 :   DeltaGFile.open(DeltaGValues);</span></a>
<a name="538"><span class="lineNum">     538 </span><span class="lineCov">          1 :   if (DeltaGFile) {</span></a>
<a name="539"><span class="lineNum">     539 </span>            :     int backboneflag = 0;</a>
<a name="540"><span class="lineNum">     540 </span><span class="lineCov">         23 :     while(getline(DeltaGFile, DeltaGline)) {</span></a>
<a name="541"><span class="lineNum">     541 </span><span class="lineCov">         22 :       if(!DeltaGline.empty()) {</span></a>
<a name="542"><span class="lineNum">     542 </span>            :         std::vector&lt;std::string&gt; DeltaGtoken;</a>
<a name="543"><span class="lineNum">     543 </span><span class="lineCov">         21 :         split(DeltaGline, DeltaGtoken);</span></a>
<a name="544"><span class="lineNum">     544 </span><span class="lineCov">       2541 :         for(unsigned i=0; i&lt;natoms; i++) {</span></a>
<a name="545"><span class="lineNum">     545 </span><span class="lineCov">       2520 :           if (DeltaGtoken[0].compare(AtomResidueName[1][i])==0 ) {</span></a>
<a name="546"><span class="lineNum">     546 </span><span class="lineCov">        120 :             DeltaG[i].push_back (std::atof(DeltaGtoken[1].c_str()));</span></a>
<a name="547"><span class="lineNum">     547 </span>            :           }</a>
<a name="548"><span class="lineNum">     548 </span>            :         }</a>
<a name="549"><span class="lineNum">     549 </span><span class="lineCov">         21 :         if (DeltaGtoken[0].compare(&quot;BACKBONE&quot;)==0 ) {</span></a>
<a name="550"><span class="lineNum">     550 </span>            :           backboneflag = 1;</a>
<a name="551"><span class="lineNum">     551 </span><span class="lineCov">          1 :           DeltaG[natoms].push_back (std::atof(DeltaGtoken[1].c_str()));</span></a>
<a name="552"><span class="lineNum">     552 </span>            :         }</a>
<a name="553"><span class="lineNum">     553 </span><span class="lineCov">         21 :       }</span></a>
<a name="554"><span class="lineNum">     554 </span>            :     }</a>
<a name="555"><span class="lineNum">     555 </span><span class="lineCov">          1 :     if ( backboneflag == 0) error(&quot;Cannot find backbone value in Delta G parameters file\n&quot;);</span></a>
<a name="556"><span class="lineNum">     556 </span>            :   }</a>
<a name="557"><span class="lineNum">     557 </span><span class="lineNoCov">          0 :   else error(&quot;Cannot open DeltaG file&quot;);</span></a>
<a name="558"><span class="lineNum">     558 </span>            : </a>
<a name="559"><span class="lineNum">     559 </span><span class="lineCov">        121 :   for(unsigned i=0; i&lt;natoms; i++) {</span></a>
<a name="560"><span class="lineNum">     560 </span><span class="lineCov">        120 :     if (DeltaG[i].size()==0 ) {</span></a>
<a name="561"><span class="lineNum">     561 </span><span class="lineNoCov">          0 :       cout &lt;&lt; &quot;Delta G value for residue &quot; &lt;&lt; AtomResidueName[1][i] &lt;&lt; &quot; not found &quot; &lt;&lt; endl;</span></a>
<a name="562"><span class="lineNum">     562 </span><span class="lineNoCov">          0 :       error (&quot;missing Delta G parameter\n&quot;);</span></a>
<a name="563"><span class="lineNum">     563 </span>            :     }</a>
<a name="564"><span class="lineNum">     564 </span>            :   }</a>
<a name="565"><span class="lineNum">     565 </span>            : </a>
<a name="566"><span class="lineNum">     566 </span><span class="lineCov">          2 : }</span></a>
<a name="567"><span class="lineNum">     567 </span>            : </a>
<a name="568"><span class="lineNum">     568 </span>            : //computes free energy values for the sidechains and for the backbone, and assigns values to each atom. Only used if sasa_type = TRANSFER, and if no DELTAGFILE is provided. In this case, the free energy values are those describing the effect of temperature, and the program must know if approach 2 or 3 (as described in Arsiccio and Shea, Protein Cold Denaturation in Implicit Solvent Simulations: A Transfer Free Energy Approach, JPCB, 2021) needs to be used to compute them.</a>
<a name="569"><span class="lineNum">     569 </span>            : </a>
<a name="570"><span class="lineNum">     570 </span><span class="lineNoCov">          0 : void SASA_LCPO::computeDeltaG() {</span></a>
<a name="571"><span class="lineNum">     571 </span>            : </a>
<a name="572"><span class="lineNum">     572 </span><span class="lineNoCov">          0 :   for(unsigned i=0; i&lt;natoms; i++) {</span></a>
<a name="573"><span class="lineNum">     573 </span><span class="lineNoCov">          0 :     DeltaG[i].clear();</span></a>
<a name="574"><span class="lineNum">     574 </span>            :   }</a>
<a name="575"><span class="lineNum">     575 </span>            : </a>
<a name="576"><span class="lineNum">     576 </span>            :   double T;</a>
<a name="577"><span class="lineNum">     577 </span><span class="lineNoCov">          0 :   T = plumed.getAtoms().getKbT()/plumed.getAtoms().getKBoltzmann();</span></a>
<a name="578"><span class="lineNum">     578 </span>            : </a>
<a name="579"><span class="lineNum">     579 </span><span class="lineNoCov">          0 :   if (T != Ti) {</span></a>
<a name="580"><span class="lineNum">     580 </span><span class="lineNoCov">          0 :     for(unsigned i=0; i&lt;natoms; i++) {</span></a>
<a name="581"><span class="lineNum">     581 </span><span class="lineNoCov">          0 :       if (approach==2) {</span></a>
<a name="582"><span class="lineNum">     582 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;ALA&quot;)==0) {</span></a>
<a name="583"><span class="lineNum">     583 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-2.995/1000*std::pow(T,2)+1.808*T-272.895);</span></a>
<a name="584"><span class="lineNum">     584 </span>            :         }</a>
<a name="585"><span class="lineNum">     585 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;ARG&quot;)==0) {</span></a>
<a name="586"><span class="lineNum">     586 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-3.182/1000*std::pow(T,2)+1.894*T-282.032);</span></a>
<a name="587"><span class="lineNum">     587 </span>            :         }</a>
<a name="588"><span class="lineNum">     588 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;ASN&quot;)==0) {</span></a>
<a name="589"><span class="lineNum">     589 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-1.047/1000*std::pow(T,2)+0.6068*T-87.846);</span></a>
<a name="590"><span class="lineNum">     590 </span>            :         }</a>
<a name="591"><span class="lineNum">     591 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;ASP&quot;)==0) {</span></a>
<a name="592"><span class="lineNum">     592 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-0.1794/1000*std::pow(T,2)+0.1091*T-16.526);</span></a>
<a name="593"><span class="lineNum">     593 </span>            :         }</a>
<a name="594"><span class="lineNum">     594 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;CYS&quot;)==0) {</span></a>
<a name="595"><span class="lineNum">     595 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-3.09/1000*std::pow(T,2)+1.835*T-272.26);</span></a>
<a name="596"><span class="lineNum">     596 </span>            :         }</a>
<a name="597"><span class="lineNum">     597 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;GLN&quot;)==0) {</span></a>
<a name="598"><span class="lineNum">     598 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-2.23/1000*std::pow(T,2)+1.335*T-199.707);</span></a>
<a name="599"><span class="lineNum">     599 </span>            :         }</a>
<a name="600"><span class="lineNum">     600 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;GLU&quot;)==0) {</span></a>
<a name="601"><span class="lineNum">     601 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-1.511/1000*std::pow(T,2)+0.8904*T-131.168);</span></a>
<a name="602"><span class="lineNum">     602 </span>            :         }</a>
<a name="603"><span class="lineNum">     603 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;GLY&quot;)==0) {</span></a>
<a name="604"><span class="lineNum">     604 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (0);</span></a>
<a name="605"><span class="lineNum">     605 </span>            :         }</a>
<a name="606"><span class="lineNum">     606 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;HIS&quot;)==0) {</span></a>
<a name="607"><span class="lineNum">     607 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-3.482/1000*std::pow(T,2)+2.084*T-311.694);</span></a>
<a name="608"><span class="lineNum">     608 </span>            :         }</a>
<a name="609"><span class="lineNum">     609 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;ILE&quot;)==0) {</span></a>
<a name="610"><span class="lineNum">     610 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-6.364/1000*std::pow(T,2)+3.8*T-567.444);</span></a>
<a name="611"><span class="lineNum">     611 </span>            :         }</a>
<a name="612"><span class="lineNum">     612 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;LEU&quot;)==0) {</span></a>
<a name="613"><span class="lineNum">     613 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-7.466/1000*std::pow(T,2)+4.417*T-653.394);</span></a>
<a name="614"><span class="lineNum">     614 </span>            :         }</a>
<a name="615"><span class="lineNum">     615 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;LYS&quot;)==0) {</span></a>
<a name="616"><span class="lineNum">     616 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-2.091/1000*std::pow(T,2)+1.2458*T-185.549);</span></a>
<a name="617"><span class="lineNum">     617 </span>            :         }</a>
<a name="618"><span class="lineNum">     618 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;MET&quot;)==0) {</span></a>
<a name="619"><span class="lineNum">     619 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-3.807/1000*std::pow(T,2)+2.272*T-339.007);</span></a>
<a name="620"><span class="lineNum">     620 </span>            :         }</a>
<a name="621"><span class="lineNum">     621 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;PHE&quot;)==0) {</span></a>
<a name="622"><span class="lineNum">     622 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-7.828/1000*std::pow(T,2)+4.644*T-688.874);</span></a>
<a name="623"><span class="lineNum">     623 </span>            :         }</a>
<a name="624"><span class="lineNum">     624 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;PRO&quot;)==0) {</span></a>
<a name="625"><span class="lineNum">     625 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-2.347/1000*std::pow(T,2)+1.411*T-212.059);</span></a>
<a name="626"><span class="lineNum">     626 </span>            :         }</a>
<a name="627"><span class="lineNum">     627 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;SER&quot;)==0) {</span></a>
<a name="628"><span class="lineNum">     628 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (1.813/1000*std::pow(T,2)-1.05*T+151.957);</span></a>
<a name="629"><span class="lineNum">     629 </span>            :         }</a>
<a name="630"><span class="lineNum">     630 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;THR&quot;)==0) {</span></a>
<a name="631"><span class="lineNum">     631 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-2.64/1000*std::pow(T,2)+1.591*T-239.516);</span></a>
<a name="632"><span class="lineNum">     632 </span>            :         }</a>
<a name="633"><span class="lineNum">     633 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;TRP&quot;)==0) {</span></a>
<a name="634"><span class="lineNum">     634 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-11.66/1000*std::pow(T,2)+6.916*T-1025.293);</span></a>
<a name="635"><span class="lineNum">     635 </span>            :         }</a>
<a name="636"><span class="lineNum">     636 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;TYR&quot;)==0) {</span></a>
<a name="637"><span class="lineNum">     637 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-7.513/1000*std::pow(T,2)+4.478*T-667.261);</span></a>
<a name="638"><span class="lineNum">     638 </span>            :         }</a>
<a name="639"><span class="lineNum">     639 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;VAL&quot;)==0) {</span></a>
<a name="640"><span class="lineNum">     640 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-4.902/1000*std::pow(T,2)+2.921*T-435.309);</span></a>
<a name="641"><span class="lineNum">     641 </span>            :         }</a>
<a name="642"><span class="lineNum">     642 </span><span class="lineNoCov">          0 :         DeltaG[natoms].push_back (-0.6962/1000*std::pow(T,2)+0.4426*T-70.015);</span></a>
<a name="643"><span class="lineNum">     643 </span>            :       }</a>
<a name="644"><span class="lineNum">     644 </span><span class="lineNoCov">          0 :       if (approach==3) {</span></a>
<a name="645"><span class="lineNum">     645 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;ALA&quot;)==0) {</span></a>
<a name="646"><span class="lineNum">     646 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-2.995/1000*std::pow(T,2)+1.808*T-272.105);</span></a>
<a name="647"><span class="lineNum">     647 </span>            :         }</a>
<a name="648"><span class="lineNum">     648 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;ARG&quot;)==0) {</span></a>
<a name="649"><span class="lineNum">     649 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-3.182/1000*std::pow(T,2)+1.894*T-284.086);</span></a>
<a name="650"><span class="lineNum">     650 </span>            :         }</a>
<a name="651"><span class="lineNum">     651 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;ASN&quot;)==0) {</span></a>
<a name="652"><span class="lineNum">     652 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-1.047/1000*std::pow(T,2)+0.6068*T-90.597);</span></a>
<a name="653"><span class="lineNum">     653 </span>            :         }</a>
<a name="654"><span class="lineNum">     654 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;ASP&quot;)==0) {</span></a>
<a name="655"><span class="lineNum">     655 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-0.1794/1000*std::pow(T,2)+0.1091*T-19.143);</span></a>
<a name="656"><span class="lineNum">     656 </span>            :         }</a>
<a name="657"><span class="lineNum">     657 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;CYS&quot;)==0) {</span></a>
<a name="658"><span class="lineNum">     658 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-3.09/1000*std::pow(T,2)+1.835*T-268.527);</span></a>
<a name="659"><span class="lineNum">     659 </span>            :         }</a>
<a name="660"><span class="lineNum">     660 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;GLN&quot;)==0) {</span></a>
<a name="661"><span class="lineNum">     661 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-2.23/1000*std::pow(T,2)+1.335*T-201.559);</span></a>
<a name="662"><span class="lineNum">     662 </span>            :         }</a>
<a name="663"><span class="lineNum">     663 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;GLU&quot;)==0) {</span></a>
<a name="664"><span class="lineNum">     664 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-1.511/1000*std::pow(T,2)+0.8904*T-133.543);</span></a>
<a name="665"><span class="lineNum">     665 </span>            :         }</a>
<a name="666"><span class="lineNum">     666 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;GLY&quot;)==0) {</span></a>
<a name="667"><span class="lineNum">     667 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (0);</span></a>
<a name="668"><span class="lineNum">     668 </span>            :         }</a>
<a name="669"><span class="lineNum">     669 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;HIS&quot;)==0) {</span></a>
<a name="670"><span class="lineNum">     670 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-3.482/1000*std::pow(T,2)+2.084*T-315.398);</span></a>
<a name="671"><span class="lineNum">     671 </span>            :         }</a>
<a name="672"><span class="lineNum">     672 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;ILE&quot;)==0) {</span></a>
<a name="673"><span class="lineNum">     673 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-6.364/1000*std::pow(T,2)+3.8*T-564.825);</span></a>
<a name="674"><span class="lineNum">     674 </span>            :         }</a>
<a name="675"><span class="lineNum">     675 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;LEU&quot;)==0) {</span></a>
<a name="676"><span class="lineNum">     676 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-7.466/1000*std::pow(T,2)+4.417*T-651.483);</span></a>
<a name="677"><span class="lineNum">     677 </span>            :         }</a>
<a name="678"><span class="lineNum">     678 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;LYS&quot;)==0) {</span></a>
<a name="679"><span class="lineNum">     679 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-2.091/1000*std::pow(T,2)+1.2458*T-187.485);</span></a>
<a name="680"><span class="lineNum">     680 </span>            :         }</a>
<a name="681"><span class="lineNum">     681 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;MET&quot;)==0) {</span></a>
<a name="682"><span class="lineNum">     682 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-3.807/1000*std::pow(T,2)+2.272*T-339.242);</span></a>
<a name="683"><span class="lineNum">     683 </span>            :         }</a>
<a name="684"><span class="lineNum">     684 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;PHE&quot;)==0) {</span></a>
<a name="685"><span class="lineNum">     685 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-7.828/1000*std::pow(T,2)+4.644*T-687.134);</span></a>
<a name="686"><span class="lineNum">     686 </span>            :         }</a>
<a name="687"><span class="lineNum">     687 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;PRO&quot;)==0) {</span></a>
<a name="688"><span class="lineNum">     688 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-2.347/1000*std::pow(T,2)+1.411*T-214.211);</span></a>
<a name="689"><span class="lineNum">     689 </span>            :         }</a>
<a name="690"><span class="lineNum">     690 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;SER&quot;)==0) {</span></a>
<a name="691"><span class="lineNum">     691 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (1.813/1000*std::pow(T,2)-1.05*T+150.289);</span></a>
<a name="692"><span class="lineNum">     692 </span>            :         }</a>
<a name="693"><span class="lineNum">     693 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;THR&quot;)==0) {</span></a>
<a name="694"><span class="lineNum">     694 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-2.64/1000*std::pow(T,2)+1.591*T-240.267);</span></a>
<a name="695"><span class="lineNum">     695 </span>            :         }</a>
<a name="696"><span class="lineNum">     696 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;TRP&quot;)==0) {</span></a>
<a name="697"><span class="lineNum">     697 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-11.66/1000*std::pow(T,2)+6.916*T-1024.284);</span></a>
<a name="698"><span class="lineNum">     698 </span>            :         }</a>
<a name="699"><span class="lineNum">     699 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;TYR&quot;)==0) {</span></a>
<a name="700"><span class="lineNum">     700 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-7.513/1000*std::pow(T,2)+4.478*T-666.484);</span></a>
<a name="701"><span class="lineNum">     701 </span>            :         }</a>
<a name="702"><span class="lineNum">     702 </span><span class="lineNoCov">          0 :         if (AtomResidueName[1][i].compare(&quot;VAL&quot;)==0) {</span></a>
<a name="703"><span class="lineNum">     703 </span><span class="lineNoCov">          0 :           DeltaG[i].push_back (-4.902/1000*std::pow(T,2)+2.921*T-433.013);</span></a>
<a name="704"><span class="lineNum">     704 </span>            :         }</a>
<a name="705"><span class="lineNum">     705 </span><span class="lineNoCov">          0 :         DeltaG[natoms].push_back (-0.6927/1000*std::pow(T,2)+0.4404*T-68.724);</span></a>
<a name="706"><span class="lineNum">     706 </span>            :       }</a>
<a name="707"><span class="lineNum">     707 </span>            :     }</a>
<a name="708"><span class="lineNum">     708 </span>            :   }</a>
<a name="709"><span class="lineNum">     709 </span>            : </a>
<a name="710"><span class="lineNum">     710 </span><span class="lineNoCov">          0 :   Ti = T;</span></a>
<a name="711"><span class="lineNum">     711 </span>            : </a>
<a name="712"><span class="lineNum">     712 </span><span class="lineNoCov">          0 :   if (firstStepFlag ==0) {</span></a>
<a name="713"><span class="lineNum">     713 </span><span class="lineNoCov">          0 :     if (approach!=2 &amp;&amp; approach!=3) {</span></a>
<a name="714"><span class="lineNum">     714 </span><span class="lineNoCov">          0 :       cout &lt;&lt; &quot;Unknown approach &quot; &lt;&lt; approach &lt;&lt; endl;</span></a>
<a name="715"><span class="lineNum">     715 </span>            :     }</a>
<a name="716"><span class="lineNum">     716 </span><span class="lineNoCov">          0 :     for(unsigned i=0; i&lt;natoms; i++) {</span></a>
<a name="717"><span class="lineNum">     717 </span><span class="lineNoCov">          0 :       if (DeltaG[i].size()==0 ) {</span></a>
<a name="718"><span class="lineNum">     718 </span><span class="lineNoCov">          0 :         cout &lt;&lt; &quot;Delta G value for residue &quot; &lt;&lt; AtomResidueName[1][i] &lt;&lt; &quot; not found &quot; &lt;&lt; endl;</span></a>
<a name="719"><span class="lineNum">     719 </span><span class="lineNoCov">          0 :         error (&quot;missing Delta G parameter\n&quot;);</span></a>
<a name="720"><span class="lineNum">     720 </span>            :       }</a>
<a name="721"><span class="lineNum">     721 </span>            :     }</a>
<a name="722"><span class="lineNum">     722 </span>            :   }</a>
<a name="723"><span class="lineNum">     723 </span><span class="lineNoCov">          0 : }</span></a>
<a name="724"><span class="lineNum">     724 </span>            : </a>
<a name="725"><span class="lineNum">     725 </span>            : </a>
<a name="726"><span class="lineNum">     726 </span>            : //calculates neighbor list</a>
<a name="727"><span class="lineNum">     727 </span><span class="lineCov">         24 : void SASA_LCPO::calcNlist() {</span></a>
<a name="728"><span class="lineNum">     728 </span><span class="lineCov">         24 :   if(!nopbc) makeWhole();</span></a>
<a name="729"><span class="lineNum">     729 </span>            : </a>
<a name="730"><span class="lineNum">     730 </span><span class="lineCov">       2904 :   for(unsigned i = 0; i &lt; natoms; i++) {</span></a>
<a name="731"><span class="lineNum">     731 </span><span class="lineCov">       2880 :     Nlist[i].clear();</span></a>
<a name="732"><span class="lineNum">     732 </span>            :   }</a>
<a name="733"><span class="lineNum">     733 </span>            : </a>
<a name="734"><span class="lineNum">     734 </span><span class="lineCov">       2904 :   for(unsigned i = 0; i &lt; natoms; i++) {</span></a>
<a name="735"><span class="lineNum">     735 </span><span class="lineCov">       2880 :     if (LCPOparam[i].size()&gt;0) {</span></a>
<a name="736"><span class="lineNum">     736 </span><span class="lineCov">      87264 :       for (unsigned j = 0; j &lt; i; j++) {</span></a>
<a name="737"><span class="lineNum">     737 </span><span class="lineCov">      85824 :         if (LCPOparam[j].size()&gt;0) {</span></a>
<a name="738"><span class="lineNum">     738 </span><span class="lineCov">      42480 :           const Vector Delta_ij_vec = delta( getPosition(i), getPosition(j) );</span></a>
<a name="739"><span class="lineNum">     739 </span><span class="lineCov">      42480 :           double Delta_ij_mod = Delta_ij_vec.modulo()*10;</span></a>
<a name="740"><span class="lineNum">     740 </span><span class="lineCov">      42480 :           double overlapD = LCPOparam[i][0]+LCPOparam[j][0];</span></a>
<a name="741"><span class="lineNum">     741 </span><span class="lineCov">      42480 :           if (Delta_ij_mod &lt; overlapD) {</span></a>
<a name="742"><span class="lineNum">     742 </span><span class="lineCov">      19030 :             Nlist.at(i).push_back (j);</span></a>
<a name="743"><span class="lineNum">     743 </span><span class="lineCov">      19030 :             Nlist.at(j).push_back (i);</span></a>
<a name="744"><span class="lineNum">     744 </span>            :           }</a>
<a name="745"><span class="lineNum">     745 </span>            :         }</a>
<a name="746"><span class="lineNum">     746 </span>            :       }</a>
<a name="747"><span class="lineNum">     747 </span>            :     }</a>
<a name="748"><span class="lineNum">     748 </span>            :   }</a>
<a name="749"><span class="lineNum">     749 </span><span class="lineCov">         24 : }</span></a>
<a name="750"><span class="lineNum">     750 </span>            : </a>
<a name="751"><span class="lineNum">     751 </span>            : </a>
<a name="752"><span class="lineNum">     752 </span>            : //calculates SASA according to LCPO algorithm</a>
<a name="753"><span class="lineNum">     753 </span><span class="lineCov">         24 : void SASA_LCPO::calculate() {</span></a>
<a name="754"><span class="lineNum">     754 </span><span class="lineCov">         24 :   if(!nopbc) makeWhole();</span></a>
<a name="755"><span class="lineNum">     755 </span>            : </a>
<a name="756"><span class="lineNum">     756 </span><span class="lineCov">         24 :   if(getExchangeStep()) nl_update = 0;</span></a>
<a name="757"><span class="lineNum">     757 </span><span class="lineCov">         24 :   if (firstStepFlag ==0) {</span></a>
<a name="758"><span class="lineNum">     758 </span><span class="lineCov">          2 :     readPDB();</span></a>
<a name="759"><span class="lineNum">     759 </span><span class="lineCov">          2 :     readLCPOparam();</span></a>
<a name="760"><span class="lineNum">     760 </span>            :   }</a>
<a name="761"><span class="lineNum">     761 </span><span class="lineCov">         24 :   if (nl_update == 0) {</span></a>
<a name="762"><span class="lineNum">     762 </span><span class="lineCov">         24 :     calcNlist();</span></a>
<a name="763"><span class="lineNum">     763 </span>            :   }</a>
<a name="764"><span class="lineNum">     764 </span>            : </a>
<a name="765"><span class="lineNum">     765 </span>            : </a>
<a name="766"><span class="lineNum">     766 </span>            : </a>
<a name="767"><span class="lineNum">     767 </span>            :   double S1, Aij, Ajk, Aijk, Aijt, Ajkt, Aikt;</a>
<a name="768"><span class="lineNum">     768 </span>            :   double dAdd;</a>
<a name="769"><span class="lineNum">     769 </span><span class="lineCov">         24 :   double sasa = 0;</span></a>
<a name="770"><span class="lineNum">     770 </span><span class="lineCov">         24 :   vector&lt;Vector&gt; derivatives( natoms );</span></a>
<a name="771"><span class="lineNum">     771 </span><span class="lineCov">         24 :   Tensor virial;</span></a>
<a name="772"><span class="lineNum">     772 </span><span class="lineCov">         24 :   vector &lt;double&gt; dAijdc_2t(3);</span></a>
<a name="773"><span class="lineNum">     773 </span><span class="lineCov">         24 :   vector &lt;double&gt; dSASA_2_neigh_dc(3);</span></a>
<a name="774"><span class="lineNum">     774 </span><span class="lineCov">         24 :   vector &lt;double&gt; ddij_di(3);</span></a>
<a name="775"><span class="lineNum">     775 </span><span class="lineCov">         24 :   vector &lt;double&gt; ddik_di(3);</span></a>
<a name="776"><span class="lineNum">     776 </span>            : </a>
<a name="777"><span class="lineNum">     777 </span><span class="lineCov">         24 :   if( sasa_type==TOTAL ) {</span></a>
<a name="778"><span class="lineNum">     778 </span><span class="lineCov">       1452 :     for(unsigned i = 0; i &lt; natoms; i++) {</span></a>
<a name="779"><span class="lineNum">     779 </span><span class="lineCov">       1440 :       derivatives[i][0] = 0.;</span></a>
<a name="780"><span class="lineNum">     780 </span><span class="lineCov">       1440 :       derivatives[i][1] = 0.;</span></a>
<a name="781"><span class="lineNum">     781 </span><span class="lineCov">       1440 :       derivatives[i][2] = 0.;</span></a>
<a name="782"><span class="lineNum">     782 </span><span class="lineCov">       1440 :       if ( LCPOparam[i].size()&gt;1) {</span></a>
<a name="783"><span class="lineNum">     783 </span><span class="lineCov">        720 :         if (LCPOparam[i][1]&gt;0.0) {</span></a>
<a name="784"><span class="lineNum">     784 </span>            :           Aij = 0.0;</a>
<a name="785"><span class="lineNum">     785 </span>            :           Aijk = 0.0;</a>
<a name="786"><span class="lineNum">     786 </span>            :           Ajk = 0.0;</a>
<a name="787"><span class="lineNum">     787 </span><span class="lineCov">        720 :           double ri = LCPOparam[i][0];</span></a>
<a name="788"><span class="lineNum">     788 </span><span class="lineCov">        720 :           S1 = 4*M_PI*ri*ri;</span></a>
<a name="789"><span class="lineNum">     789 </span><span class="lineCov">        720 :           vector &lt;double&gt; dAijdc_2(3, 0);</span></a>
<a name="790"><span class="lineNum">     790 </span><span class="lineCov">        720 :           vector &lt;double&gt; dAijdc_4(3, 0);</span></a>
<a name="791"><span class="lineNum">     791 </span>            : </a>
<a name="792"><span class="lineNum">     792 </span>            : </a>
<a name="793"><span class="lineNum">     793 </span><span class="lineCov">      19750 :           for (unsigned j = 0; j &lt; Nlist[i].size(); j++) {</span></a>
<a name="794"><span class="lineNum">     794 </span><span class="lineCov">      19030 :             const Vector d_ij_vec = delta( getPosition(i), getPosition(Nlist[i][j]) );</span></a>
<a name="795"><span class="lineNum">     795 </span><span class="lineCov">      19030 :             double d_ij = d_ij_vec.modulo()*10;</span></a>
<a name="796"><span class="lineNum">     796 </span>            : </a>
<a name="797"><span class="lineNum">     797 </span><span class="lineCov">      19030 :             double rj = LCPOparam[Nlist[i][j]][0];</span></a>
<a name="798"><span class="lineNum">     798 </span><span class="lineCov">      19030 :             Aijt = (2*M_PI*ri*(ri-d_ij/2-((ri*ri-rj*rj)/(2*d_ij))));</span></a>
<a name="799"><span class="lineNum">     799 </span><span class="lineCov">      19030 :             double sji = (2*M_PI*rj*(rj-d_ij/2+((ri*ri-rj*rj)/(2*d_ij))));</span></a>
<a name="800"><span class="lineNum">     800 </span>            : </a>
<a name="801"><span class="lineNum">     801 </span><span class="lineCov">      19030 :             dAdd = M_PI*rj*(-(ri*ri-rj*rj)/(d_ij*d_ij)-1);</span></a>
<a name="802"><span class="lineNum">     802 </span>            : </a>
<a name="803"><span class="lineNum">     803 </span><span class="lineCov">      19030 :             ddij_di[0] = -10*(getPosition(Nlist[i][j])[0]-getPosition(i)[0])/d_ij;</span></a>
<a name="804"><span class="lineNum">     804 </span><span class="lineCov">      19030 :             ddij_di[1] = -10*(getPosition(Nlist[i][j])[1]-getPosition(i)[1])/d_ij;</span></a>
<a name="805"><span class="lineNum">     805 </span><span class="lineCov">      19030 :             ddij_di[2] = -10*(getPosition(Nlist[i][j])[2]-getPosition(i)[2])/d_ij;</span></a>
<a name="806"><span class="lineNum">     806 </span>            : </a>
<a name="807"><span class="lineNum">     807 </span>            :             Ajkt = 0.0;</a>
<a name="808"><span class="lineNum">     808 </span>            :             Aikt = 0.0;</a>
<a name="809"><span class="lineNum">     809 </span>            : </a>
<a name="810"><span class="lineNum">     810 </span><span class="lineCov">      19030 :             vector &lt;double&gt; dSASA_3_neigh_dc(3, 0.0);</span></a>
<a name="811"><span class="lineNum">     811 </span><span class="lineCov">      19030 :             vector &lt;double&gt; dSASA_4_neigh_dc(3, 0.0);</span></a>
<a name="812"><span class="lineNum">     812 </span><span class="lineCov">      19030 :             vector &lt;double&gt; dSASA_3_neigh_dc2(3, 0.0);</span></a>
<a name="813"><span class="lineNum">     813 </span><span class="lineCov">      19030 :             vector &lt;double&gt; dSASA_4_neigh_dc2(3, 0.0);</span></a>
<a name="814"><span class="lineNum">     814 </span>            : </a>
<a name="815"><span class="lineNum">     815 </span><span class="lineCov">      19030 :             dSASA_2_neigh_dc[0] = dAdd * ddij_di[0];</span></a>
<a name="816"><span class="lineNum">     816 </span><span class="lineCov">      19030 :             dSASA_2_neigh_dc[1] = dAdd * ddij_di[1];</span></a>
<a name="817"><span class="lineNum">     817 </span><span class="lineCov">      19030 :             dSASA_2_neigh_dc[2] = dAdd * ddij_di[2];</span></a>
<a name="818"><span class="lineNum">     818 </span>            : </a>
<a name="819"><span class="lineNum">     819 </span><span class="lineCov">      19030 :             dAdd = M_PI*ri*((ri*ri-rj*rj)/(d_ij*d_ij)-1);</span></a>
<a name="820"><span class="lineNum">     820 </span>            : </a>
<a name="821"><span class="lineNum">     821 </span>            : </a>
<a name="822"><span class="lineNum">     822 </span><span class="lineCov">      19030 :             dAijdc_2t[0] = dAdd * ddij_di[0];</span></a>
<a name="823"><span class="lineNum">     823 </span><span class="lineCov">      19030 :             dAijdc_2t[1] = dAdd * ddij_di[1];</span></a>
<a name="824"><span class="lineNum">     824 </span><span class="lineCov">      19030 :             dAijdc_2t[2] = dAdd * ddij_di[2];</span></a>
<a name="825"><span class="lineNum">     825 </span>            : </a>
<a name="826"><span class="lineNum">     826 </span><span class="lineCov">     560038 :             for (unsigned k = 0; k &lt; Nlist[Nlist[i][j]].size(); k++) {</span></a>
<a name="827"><span class="lineNum">     827 </span><span class="lineCov">     541008 :               if (std::find (Nlist[i].begin(), Nlist[i].end(), Nlist[Nlist[i][j]][k]) !=  Nlist[i].end()) {</span></a>
<a name="828"><span class="lineNum">     828 </span><span class="lineCov">     370872 :                 const Vector d_jk_vec = delta( getPosition(Nlist[i][j]), getPosition(Nlist[Nlist[i][j]][k]) );</span></a>
<a name="829"><span class="lineNum">     829 </span><span class="lineCov">     370872 :                 const Vector d_ik_vec = delta( getPosition(i), getPosition(Nlist[Nlist[i][j]][k]) );</span></a>
<a name="830"><span class="lineNum">     830 </span>            : </a>
<a name="831"><span class="lineNum">     831 </span><span class="lineCov">     370872 :                 double d_jk = d_jk_vec.modulo()*10;</span></a>
<a name="832"><span class="lineNum">     832 </span><span class="lineCov">     370872 :                 double d_ik = d_ik_vec.modulo()*10;</span></a>
<a name="833"><span class="lineNum">     833 </span>            : </a>
<a name="834"><span class="lineNum">     834 </span><span class="lineCov">     370872 :                 double rk = LCPOparam[Nlist[Nlist[i][j]][k]][0];</span></a>
<a name="835"><span class="lineNum">     835 </span><span class="lineCov">     370872 :                 double sjk =  (2*M_PI*rj*(rj-d_jk/2-((rj*rj-rk*rk)/(2*d_jk))));</span></a>
<a name="836"><span class="lineNum">     836 </span><span class="lineCov">     370872 :                 Ajkt += sjk;</span></a>
<a name="837"><span class="lineNum">     837 </span><span class="lineCov">     370872 :                 Aikt += (2*M_PI*ri*(ri-d_ik/2-((ri*ri-rk*rk)/(2*d_ik))));</span></a>
<a name="838"><span class="lineNum">     838 </span>            : </a>
<a name="839"><span class="lineNum">     839 </span><span class="lineCov">     370872 :                 dAdd = M_PI*ri*((ri*ri-rk*rk)/(d_ik*d_ik)-1);</span></a>
<a name="840"><span class="lineNum">     840 </span>            : </a>
<a name="841"><span class="lineNum">     841 </span><span class="lineCov">     370872 :                 ddik_di[0] = -10*(getPosition(Nlist[Nlist[i][j]][k])[0]-getPosition(i)[0])/d_ik;</span></a>
<a name="842"><span class="lineNum">     842 </span><span class="lineCov">     370872 :                 ddik_di[1] = -10*(getPosition(Nlist[Nlist[i][j]][k])[1]-getPosition(i)[1])/d_ik;</span></a>
<a name="843"><span class="lineNum">     843 </span><span class="lineCov">     370872 :                 ddik_di[2] = -10*(getPosition(Nlist[Nlist[i][j]][k])[2]-getPosition(i)[2])/d_ik;</span></a>
<a name="844"><span class="lineNum">     844 </span>            : </a>
<a name="845"><span class="lineNum">     845 </span>            : </a>
<a name="846"><span class="lineNum">     846 </span><span class="lineCov">     370872 :                 dSASA_3_neigh_dc[0] += dAdd*ddik_di[0];</span></a>
<a name="847"><span class="lineNum">     847 </span><span class="lineCov">     370872 :                 dSASA_3_neigh_dc[1] += dAdd*ddik_di[1];</span></a>
<a name="848"><span class="lineNum">     848 </span><span class="lineCov">     370872 :                 dSASA_3_neigh_dc[2] += dAdd*ddik_di[2];</span></a>
<a name="849"><span class="lineNum">     849 </span>            : </a>
<a name="850"><span class="lineNum">     850 </span><span class="lineCov">     370872 :                 dAdd = M_PI*rk*(-(ri*ri-rk*rk)/(d_ik*d_ik)-1);</span></a>
<a name="851"><span class="lineNum">     851 </span>            : </a>
<a name="852"><span class="lineNum">     852 </span><span class="lineCov">     370872 :                 dSASA_3_neigh_dc2[0] += dAdd*ddik_di[0];</span></a>
<a name="853"><span class="lineNum">     853 </span><span class="lineCov">     370872 :                 dSASA_3_neigh_dc2[1] += dAdd*ddik_di[1];</span></a>
<a name="854"><span class="lineNum">     854 </span><span class="lineCov">     370872 :                 dSASA_3_neigh_dc2[2] += dAdd*ddik_di[2];</span></a>
<a name="855"><span class="lineNum">     855 </span>            : </a>
<a name="856"><span class="lineNum">     856 </span><span class="lineCov">     370872 :                 dSASA_4_neigh_dc2[0] += sjk*dAdd*ddik_di[0];</span></a>
<a name="857"><span class="lineNum">     857 </span><span class="lineCov">     370872 :                 dSASA_4_neigh_dc2[1] += sjk*dAdd*ddik_di[1];</span></a>
<a name="858"><span class="lineNum">     858 </span><span class="lineCov">     370872 :                 dSASA_4_neigh_dc2[2] += sjk*dAdd*ddik_di[2];</span></a>
<a name="859"><span class="lineNum">     859 </span>            : </a>
<a name="860"><span class="lineNum">     860 </span>            :               }</a>
<a name="861"><span class="lineNum">     861 </span>            :             }</a>
<a name="862"><span class="lineNum">     862 </span><span class="lineCov">      19030 :             dSASA_4_neigh_dc[0] = sji*dSASA_3_neigh_dc[0] + dSASA_4_neigh_dc2[0];</span></a>
<a name="863"><span class="lineNum">     863 </span><span class="lineCov">      19030 :             dSASA_4_neigh_dc[1] = sji*dSASA_3_neigh_dc[1] + dSASA_4_neigh_dc2[1];</span></a>
<a name="864"><span class="lineNum">     864 </span><span class="lineCov">      19030 :             dSASA_4_neigh_dc[2] = sji*dSASA_3_neigh_dc[2] + dSASA_4_neigh_dc2[2];</span></a>
<a name="865"><span class="lineNum">     865 </span>            : </a>
<a name="866"><span class="lineNum">     866 </span><span class="lineCov">      19030 :             dSASA_3_neigh_dc[0] += dSASA_3_neigh_dc2[0];</span></a>
<a name="867"><span class="lineNum">     867 </span><span class="lineCov">      19030 :             dSASA_3_neigh_dc[1] += dSASA_3_neigh_dc2[1];</span></a>
<a name="868"><span class="lineNum">     868 </span><span class="lineCov">      19030 :             dSASA_3_neigh_dc[2] += dSASA_3_neigh_dc2[2];</span></a>
<a name="869"><span class="lineNum">     869 </span>            : </a>
<a name="870"><span class="lineNum">     870 </span><span class="lineCov">      19030 :             dSASA_4_neigh_dc[0] += dSASA_2_neigh_dc[0] * Aikt;</span></a>
<a name="871"><span class="lineNum">     871 </span><span class="lineCov">      19030 :             dSASA_4_neigh_dc[1] += dSASA_2_neigh_dc[1] * Aikt;</span></a>
<a name="872"><span class="lineNum">     872 </span><span class="lineCov">      19030 :             dSASA_4_neigh_dc[2] += dSASA_2_neigh_dc[2] * Aikt;</span></a>
<a name="873"><span class="lineNum">     873 </span>            : </a>
<a name="874"><span class="lineNum">     874 </span>            : </a>
<a name="875"><span class="lineNum">     875 </span><span class="lineCov">      19030 :             derivatives[i][0] += (dSASA_2_neigh_dc[0]*LCPOparam[Nlist[i][j]][2] + dSASA_3_neigh_dc[0]*LCPOparam[Nlist[i][j]][3]+dSASA_4_neigh_dc[0]*LCPOparam[Nlist[i][j]][4])/10;</span></a>
<a name="876"><span class="lineNum">     876 </span><span class="lineCov">      19030 :             derivatives[i][1] += (dSASA_2_neigh_dc[1]*LCPOparam[Nlist[i][j]][2] + dSASA_3_neigh_dc[1]*LCPOparam[Nlist[i][j]][3]+dSASA_4_neigh_dc[1]*LCPOparam[Nlist[i][j]][4])/10;</span></a>
<a name="877"><span class="lineNum">     877 </span><span class="lineCov">      19030 :             derivatives[i][2] += (dSASA_2_neigh_dc[2]*LCPOparam[Nlist[i][j]][2] + dSASA_3_neigh_dc[2]*LCPOparam[Nlist[i][j]][3]+dSASA_4_neigh_dc[2]*LCPOparam[Nlist[i][j]][4])/10;</span></a>
<a name="878"><span class="lineNum">     878 </span>            : </a>
<a name="879"><span class="lineNum">     879 </span>            : </a>
<a name="880"><span class="lineNum">     880 </span><span class="lineCov">      19030 :             Aijk += (Aijt * Ajkt);</span></a>
<a name="881"><span class="lineNum">     881 </span><span class="lineCov">      19030 :             Aij += Aijt;</span></a>
<a name="882"><span class="lineNum">     882 </span><span class="lineCov">      19030 :             Ajk += Ajkt;</span></a>
<a name="883"><span class="lineNum">     883 </span>            : </a>
<a name="884"><span class="lineNum">     884 </span><span class="lineCov">      19030 :             dAijdc_2[0] += dAijdc_2t[0];</span></a>
<a name="885"><span class="lineNum">     885 </span><span class="lineCov">      19030 :             dAijdc_2[1] += dAijdc_2t[1];</span></a>
<a name="886"><span class="lineNum">     886 </span><span class="lineCov">      19030 :             dAijdc_2[2] += dAijdc_2t[2];</span></a>
<a name="887"><span class="lineNum">     887 </span>            : </a>
<a name="888"><span class="lineNum">     888 </span>            : </a>
<a name="889"><span class="lineNum">     889 </span><span class="lineCov">      19030 :             dAijdc_4[0] += Ajkt*dAijdc_2t[0];</span></a>
<a name="890"><span class="lineNum">     890 </span><span class="lineCov">      19030 :             dAijdc_4[1] += Ajkt*dAijdc_2t[1];</span></a>
<a name="891"><span class="lineNum">     891 </span><span class="lineCov">      19030 :             dAijdc_4[2] += Ajkt*dAijdc_2t[2];</span></a>
<a name="892"><span class="lineNum">     892 </span>            : </a>
<a name="893"><span class="lineNum">     893 </span>            : </a>
<a name="894"><span class="lineNum">     894 </span>            :           }</a>
<a name="895"><span class="lineNum">     895 </span><span class="lineCov">        720 :           double sasai = (LCPOparam[i][1]*S1+LCPOparam[i][2]*Aij+LCPOparam[i][3]*Ajk+LCPOparam[i][4]*Aijk);</span></a>
<a name="896"><span class="lineNum">     896 </span><span class="lineCov">        720 :           if (sasai &gt; 0 ) sasa += sasai/100;</span></a>
<a name="897"><span class="lineNum">     897 </span><span class="lineCov">        720 :           derivatives[i][0] += (dAijdc_2[0]*LCPOparam[i][2]+dAijdc_4[0]*LCPOparam[i][4])/10;</span></a>
<a name="898"><span class="lineNum">     898 </span><span class="lineCov">        720 :           derivatives[i][1] += (dAijdc_2[1]*LCPOparam[i][2]+dAijdc_4[1]*LCPOparam[i][4])/10;</span></a>
<a name="899"><span class="lineNum">     899 </span><span class="lineCov">        720 :           derivatives[i][2] += (dAijdc_2[2]*LCPOparam[i][2]+dAijdc_4[2]*LCPOparam[i][4])/10;</span></a>
<a name="900"><span class="lineNum">     900 </span>            :         }</a>
<a name="901"><span class="lineNum">     901 </span>            :       }</a>
<a name="902"><span class="lineNum">     902 </span><span class="lineCov">       1440 :       virial -= Tensor(getPosition(i),derivatives[i]);</span></a>
<a name="903"><span class="lineNum">     903 </span>            :     }</a>
<a name="904"><span class="lineNum">     904 </span>            :   }</a>
<a name="905"><span class="lineNum">     905 </span>            : </a>
<a name="906"><span class="lineNum">     906 </span>            : </a>
<a name="907"><span class="lineNum">     907 </span>            : </a>
<a name="908"><span class="lineNum">     908 </span><span class="lineCov">         24 :   if( sasa_type==TRANSFER ) {</span></a>
<a name="909"><span class="lineNum">     909 </span>            : </a>
<a name="910"><span class="lineNum">     910 </span><span class="lineCov">         12 :     if (firstStepFlag ==0) {</span></a>
<a name="911"><span class="lineNum">     911 </span><span class="lineCov">          1 :       readMaxSurf();</span></a>
<a name="912"><span class="lineNum">     912 </span>            :     }</a>
<a name="913"><span class="lineNum">     913 </span>            : </a>
<a name="914"><span class="lineNum">     914 </span><span class="lineCov">         12 :     if (firstStepFlag ==0 &amp;&amp; DeltaGValues != &quot;absent&quot;) {</span></a>
<a name="915"><span class="lineNum">     915 </span><span class="lineCov">          1 :       readDeltaG();</span></a>
<a name="916"><span class="lineNum">     916 </span>            :     }</a>
<a name="917"><span class="lineNum">     917 </span>            : </a>
<a name="918"><span class="lineNum">     918 </span><span class="lineCov">         12 :     if (DeltaGValues == &quot;absent&quot;) {</span></a>
<a name="919"><span class="lineNum">     919 </span><span class="lineNoCov">          0 :       computeDeltaG();</span></a>
<a name="920"><span class="lineNum">     920 </span>            :     }</a>
<a name="921"><span class="lineNum">     921 </span>            : </a>
<a name="922"><span class="lineNum">     922 </span>            : </a>
<a name="923"><span class="lineNum">     923 </span><span class="lineCov">       1452 :     for(unsigned i = 0; i &lt; natoms; i++) {</span></a>
<a name="924"><span class="lineNum">     924 </span>            : </a>
<a name="925"><span class="lineNum">     925 </span>            : </a>
<a name="926"><span class="lineNum">     926 </span>            : </a>
<a name="927"><span class="lineNum">     927 </span><span class="lineCov">       1440 :       derivatives[i][0] = 0.;</span></a>
<a name="928"><span class="lineNum">     928 </span><span class="lineCov">       1440 :       derivatives[i][1] = 0.;</span></a>
<a name="929"><span class="lineNum">     929 </span><span class="lineCov">       1440 :       derivatives[i][2] = 0.;</span></a>
<a name="930"><span class="lineNum">     930 </span>            : </a>
<a name="931"><span class="lineNum">     931 </span><span class="lineCov">       1440 :       if ( LCPOparam[i].size()&gt;1) {</span></a>
<a name="932"><span class="lineNum">     932 </span><span class="lineCov">        720 :         if (LCPOparam[i][1]&gt;0.0) {</span></a>
<a name="933"><span class="lineNum">     933 </span>            :           Aij = 0.0;</a>
<a name="934"><span class="lineNum">     934 </span>            :           Aijk = 0.0;</a>
<a name="935"><span class="lineNum">     935 </span>            :           Ajk = 0.0;</a>
<a name="936"><span class="lineNum">     936 </span><span class="lineCov">        720 :           double ri = LCPOparam[i][0];</span></a>
<a name="937"><span class="lineNum">     937 </span><span class="lineCov">        720 :           S1 = 4*M_PI*ri*ri;</span></a>
<a name="938"><span class="lineNum">     938 </span><span class="lineCov">        720 :           vector &lt;double&gt; dAijdc_2(3, 0);</span></a>
<a name="939"><span class="lineNum">     939 </span><span class="lineCov">        720 :           vector &lt;double&gt; dAijdc_4(3, 0);</span></a>
<a name="940"><span class="lineNum">     940 </span>            : </a>
<a name="941"><span class="lineNum">     941 </span>            : </a>
<a name="942"><span class="lineNum">     942 </span><span class="lineCov">      19750 :           for (unsigned j = 0; j &lt; Nlist[i].size(); j++) {</span></a>
<a name="943"><span class="lineNum">     943 </span><span class="lineCov">      19030 :             const Vector d_ij_vec = delta( getPosition(i), getPosition(Nlist[i][j]) );</span></a>
<a name="944"><span class="lineNum">     944 </span><span class="lineCov">      19030 :             double d_ij = d_ij_vec.modulo()*10;</span></a>
<a name="945"><span class="lineNum">     945 </span>            : </a>
<a name="946"><span class="lineNum">     946 </span><span class="lineCov">      19030 :             double rj = LCPOparam[Nlist[i][j]][0];</span></a>
<a name="947"><span class="lineNum">     947 </span><span class="lineCov">      19030 :             Aijt = (2*M_PI*ri*(ri-d_ij/2-((ri*ri-rj*rj)/(2*d_ij))));</span></a>
<a name="948"><span class="lineNum">     948 </span><span class="lineCov">      19030 :             double sji = (2*M_PI*rj*(rj-d_ij/2+((ri*ri-rj*rj)/(2*d_ij))));</span></a>
<a name="949"><span class="lineNum">     949 </span>            : </a>
<a name="950"><span class="lineNum">     950 </span><span class="lineCov">      19030 :             dAdd = M_PI*rj*(-(ri*ri-rj*rj)/(d_ij*d_ij)-1);</span></a>
<a name="951"><span class="lineNum">     951 </span><span class="lineCov">      19030 :             ddij_di[0] = -10*(getPosition(Nlist[i][j])[0]-getPosition(i)[0])/d_ij;</span></a>
<a name="952"><span class="lineNum">     952 </span><span class="lineCov">      19030 :             ddij_di[1] = -10*(getPosition(Nlist[i][j])[1]-getPosition(i)[1])/d_ij;</span></a>
<a name="953"><span class="lineNum">     953 </span><span class="lineCov">      19030 :             ddij_di[2] = -10*(getPosition(Nlist[i][j])[2]-getPosition(i)[2])/d_ij;</span></a>
<a name="954"><span class="lineNum">     954 </span>            : </a>
<a name="955"><span class="lineNum">     955 </span>            :             Ajkt = 0.0;</a>
<a name="956"><span class="lineNum">     956 </span>            :             Aikt = 0.0;</a>
<a name="957"><span class="lineNum">     957 </span>            : </a>
<a name="958"><span class="lineNum">     958 </span><span class="lineCov">      19030 :             vector &lt;double&gt; dSASA_3_neigh_dc(3, 0.0);</span></a>
<a name="959"><span class="lineNum">     959 </span><span class="lineCov">      19030 :             vector &lt;double&gt; dSASA_4_neigh_dc(3, 0.0);</span></a>
<a name="960"><span class="lineNum">     960 </span><span class="lineCov">      19030 :             vector &lt;double&gt; dSASA_3_neigh_dc2(3, 0.0);</span></a>
<a name="961"><span class="lineNum">     961 </span><span class="lineCov">      19030 :             vector &lt;double&gt; dSASA_4_neigh_dc2(3, 0.0);</span></a>
<a name="962"><span class="lineNum">     962 </span>            : </a>
<a name="963"><span class="lineNum">     963 </span><span class="lineCov">      19030 :             dSASA_2_neigh_dc[0] = dAdd * ddij_di[0];</span></a>
<a name="964"><span class="lineNum">     964 </span><span class="lineCov">      19030 :             dSASA_2_neigh_dc[1] = dAdd * ddij_di[1];</span></a>
<a name="965"><span class="lineNum">     965 </span><span class="lineCov">      19030 :             dSASA_2_neigh_dc[2] = dAdd * ddij_di[2];</span></a>
<a name="966"><span class="lineNum">     966 </span>            : </a>
<a name="967"><span class="lineNum">     967 </span><span class="lineCov">      19030 :             dAdd = M_PI*ri*((ri*ri-rj*rj)/(d_ij*d_ij)-1);</span></a>
<a name="968"><span class="lineNum">     968 </span>            : </a>
<a name="969"><span class="lineNum">     969 </span><span class="lineCov">      19030 :             dAijdc_2t[0] = dAdd * ddij_di[0];</span></a>
<a name="970"><span class="lineNum">     970 </span><span class="lineCov">      19030 :             dAijdc_2t[1] = dAdd * ddij_di[1];</span></a>
<a name="971"><span class="lineNum">     971 </span><span class="lineCov">      19030 :             dAijdc_2t[2] = dAdd * ddij_di[2];</span></a>
<a name="972"><span class="lineNum">     972 </span>            : </a>
<a name="973"><span class="lineNum">     973 </span><span class="lineCov">     560038 :             for (unsigned k = 0; k &lt; Nlist[Nlist[i][j]].size(); k++) {</span></a>
<a name="974"><span class="lineNum">     974 </span><span class="lineCov">     541008 :               if (std::find (Nlist[i].begin(), Nlist[i].end(), Nlist[Nlist[i][j]][k]) !=  Nlist[i].end()) {</span></a>
<a name="975"><span class="lineNum">     975 </span><span class="lineCov">     370872 :                 const Vector d_jk_vec = delta( getPosition(Nlist[i][j]), getPosition(Nlist[Nlist[i][j]][k]) );</span></a>
<a name="976"><span class="lineNum">     976 </span><span class="lineCov">     370872 :                 const Vector d_ik_vec = delta( getPosition(i), getPosition(Nlist[Nlist[i][j]][k]) );</span></a>
<a name="977"><span class="lineNum">     977 </span>            : </a>
<a name="978"><span class="lineNum">     978 </span><span class="lineCov">     370872 :                 double d_jk = d_jk_vec.modulo()*10;</span></a>
<a name="979"><span class="lineNum">     979 </span><span class="lineCov">     370872 :                 double d_ik = d_ik_vec.modulo()*10;</span></a>
<a name="980"><span class="lineNum">     980 </span>            : </a>
<a name="981"><span class="lineNum">     981 </span><span class="lineCov">     370872 :                 double rk = LCPOparam[Nlist[Nlist[i][j]][k]][0];</span></a>
<a name="982"><span class="lineNum">     982 </span><span class="lineCov">     370872 :                 double sjk =  (2*M_PI*rj*(rj-d_jk/2-((rj*rj-rk*rk)/(2*d_jk))));</span></a>
<a name="983"><span class="lineNum">     983 </span><span class="lineCov">     370872 :                 Ajkt += sjk;</span></a>
<a name="984"><span class="lineNum">     984 </span><span class="lineCov">     370872 :                 Aikt += (2*M_PI*ri*(ri-d_ik/2-((ri*ri-rk*rk)/(2*d_ik))));</span></a>
<a name="985"><span class="lineNum">     985 </span>            : </a>
<a name="986"><span class="lineNum">     986 </span><span class="lineCov">     370872 :                 dAdd = M_PI*ri*((ri*ri-rk*rk)/(d_ik*d_ik)-1);</span></a>
<a name="987"><span class="lineNum">     987 </span>            : </a>
<a name="988"><span class="lineNum">     988 </span><span class="lineCov">     370872 :                 ddik_di[0] = -10*(getPosition(Nlist[Nlist[i][j]][k])[0]-getPosition(i)[0])/d_ik;</span></a>
<a name="989"><span class="lineNum">     989 </span><span class="lineCov">     370872 :                 ddik_di[1] = -10*(getPosition(Nlist[Nlist[i][j]][k])[1]-getPosition(i)[1])/d_ik;</span></a>
<a name="990"><span class="lineNum">     990 </span><span class="lineCov">     370872 :                 ddik_di[2] = -10*(getPosition(Nlist[Nlist[i][j]][k])[2]-getPosition(i)[2])/d_ik;</span></a>
<a name="991"><span class="lineNum">     991 </span>            : </a>
<a name="992"><span class="lineNum">     992 </span>            : </a>
<a name="993"><span class="lineNum">     993 </span><span class="lineCov">     370872 :                 dSASA_3_neigh_dc[0] += dAdd*ddik_di[0];</span></a>
<a name="994"><span class="lineNum">     994 </span><span class="lineCov">     370872 :                 dSASA_3_neigh_dc[1] += dAdd*ddik_di[1];</span></a>
<a name="995"><span class="lineNum">     995 </span><span class="lineCov">     370872 :                 dSASA_3_neigh_dc[2] += dAdd*ddik_di[2];</span></a>
<a name="996"><span class="lineNum">     996 </span>            : </a>
<a name="997"><span class="lineNum">     997 </span><span class="lineCov">     370872 :                 dAdd = M_PI*rk*(-(ri*ri-rk*rk)/(d_ik*d_ik)-1);</span></a>
<a name="998"><span class="lineNum">     998 </span>            : </a>
<a name="999"><span class="lineNum">     999 </span><span class="lineCov">     370872 :                 dSASA_3_neigh_dc2[0] += dAdd*ddik_di[0];</span></a>
<a name="1000"><span class="lineNum">    1000 </span><span class="lineCov">     370872 :                 dSASA_3_neigh_dc2[1] += dAdd*ddik_di[1];</span></a>
<a name="1001"><span class="lineNum">    1001 </span><span class="lineCov">     370872 :                 dSASA_3_neigh_dc2[2] += dAdd*ddik_di[2];</span></a>
<a name="1002"><span class="lineNum">    1002 </span>            : </a>
<a name="1003"><span class="lineNum">    1003 </span><span class="lineCov">     370872 :                 dSASA_4_neigh_dc2[0] += sjk*dAdd*ddik_di[0];</span></a>
<a name="1004"><span class="lineNum">    1004 </span><span class="lineCov">     370872 :                 dSASA_4_neigh_dc2[1] += sjk*dAdd*ddik_di[1];</span></a>
<a name="1005"><span class="lineNum">    1005 </span><span class="lineCov">     370872 :                 dSASA_4_neigh_dc2[2] += sjk*dAdd*ddik_di[2];</span></a>
<a name="1006"><span class="lineNum">    1006 </span>            : </a>
<a name="1007"><span class="lineNum">    1007 </span>            :               }</a>
<a name="1008"><span class="lineNum">    1008 </span>            :             }</a>
<a name="1009"><span class="lineNum">    1009 </span><span class="lineCov">      19030 :             dSASA_4_neigh_dc[0] = sji*dSASA_3_neigh_dc[0] + dSASA_4_neigh_dc2[0];</span></a>
<a name="1010"><span class="lineNum">    1010 </span><span class="lineCov">      19030 :             dSASA_4_neigh_dc[1] = sji*dSASA_3_neigh_dc[1] + dSASA_4_neigh_dc2[1];</span></a>
<a name="1011"><span class="lineNum">    1011 </span><span class="lineCov">      19030 :             dSASA_4_neigh_dc[2] = sji*dSASA_3_neigh_dc[2] + dSASA_4_neigh_dc2[2];</span></a>
<a name="1012"><span class="lineNum">    1012 </span>            : </a>
<a name="1013"><span class="lineNum">    1013 </span><span class="lineCov">      19030 :             dSASA_3_neigh_dc[0] += dSASA_3_neigh_dc2[0];</span></a>
<a name="1014"><span class="lineNum">    1014 </span><span class="lineCov">      19030 :             dSASA_3_neigh_dc[1] += dSASA_3_neigh_dc2[1];</span></a>
<a name="1015"><span class="lineNum">    1015 </span><span class="lineCov">      19030 :             dSASA_3_neigh_dc[2] += dSASA_3_neigh_dc2[2];</span></a>
<a name="1016"><span class="lineNum">    1016 </span>            : </a>
<a name="1017"><span class="lineNum">    1017 </span><span class="lineCov">      19030 :             dSASA_4_neigh_dc[0] += dSASA_2_neigh_dc[0] * Aikt;</span></a>
<a name="1018"><span class="lineNum">    1018 </span><span class="lineCov">      19030 :             dSASA_4_neigh_dc[1] += dSASA_2_neigh_dc[1] * Aikt;</span></a>
<a name="1019"><span class="lineNum">    1019 </span><span class="lineCov">      19030 :             dSASA_4_neigh_dc[2] += dSASA_2_neigh_dc[2] * Aikt;</span></a>
<a name="1020"><span class="lineNum">    1020 </span>            : </a>
<a name="1021"><span class="lineNum">    1021 </span><span class="lineCov">      19030 :             if (AtomResidueName[0][Nlist[i][j]] == &quot;N&quot; || AtomResidueName[0][Nlist[i][j]] == &quot;CA&quot;  || AtomResidueName[0][Nlist[i][j]] == &quot;C&quot; || AtomResidueName[0][Nlist[i][j]] == &quot;O&quot;) {</span></a>
<a name="1022"><span class="lineNum">    1022 </span><span class="lineCov">      15720 :               derivatives[i][0] += ((dSASA_2_neigh_dc[0]*LCPOparam[Nlist[i][j]][2] + dSASA_3_neigh_dc[0]*LCPOparam[Nlist[i][j]][3]+dSASA_4_neigh_dc[0]*LCPOparam[Nlist[i][j]][4])/MaxSurf[Nlist[i][j]][0]*DeltaG[natoms][0])*10;</span></a>
<a name="1023"><span class="lineNum">    1023 </span><span class="lineCov">      15720 :               derivatives[i][1] += ((dSASA_2_neigh_dc[1]*LCPOparam[Nlist[i][j]][2] + dSASA_3_neigh_dc[1]*LCPOparam[Nlist[i][j]][3]+dSASA_4_neigh_dc[1]*LCPOparam[Nlist[i][j]][4])/MaxSurf[Nlist[i][j]][0]*DeltaG[natoms][0])*10;</span></a>
<a name="1024"><span class="lineNum">    1024 </span><span class="lineCov">      15720 :               derivatives[i][2] += ((dSASA_2_neigh_dc[2]*LCPOparam[Nlist[i][j]][2] + dSASA_3_neigh_dc[2]*LCPOparam[Nlist[i][j]][3]+dSASA_4_neigh_dc[2]*LCPOparam[Nlist[i][j]][4])/MaxSurf[Nlist[i][j]][0]*DeltaG[natoms][0])*10;</span></a>
<a name="1025"><span class="lineNum">    1025 </span>            :             }</a>
<a name="1026"><span class="lineNum">    1026 </span>            : </a>
<a name="1027"><span class="lineNum">    1027 </span><span class="lineCov">      19030 :             if (AtomResidueName[0][Nlist[i][j]] != &quot;N&quot; &amp;&amp; AtomResidueName[0][Nlist[i][j]] != &quot;CA&quot;  &amp;&amp; AtomResidueName[0][Nlist[i][j]] != &quot;C&quot; &amp;&amp; AtomResidueName[0][Nlist[i][j]] != &quot;O&quot;) {</span></a>
<a name="1028"><span class="lineNum">    1028 </span><span class="lineCov">       3310 :               derivatives[i][0] += ((dSASA_2_neigh_dc[0]*LCPOparam[Nlist[i][j]][2] + dSASA_3_neigh_dc[0]*LCPOparam[Nlist[i][j]][3]+dSASA_4_neigh_dc[0]*LCPOparam[Nlist[i][j]][4])/MaxSurf[Nlist[i][j]][1]*DeltaG[Nlist[i][j]][0])*10;</span></a>
<a name="1029"><span class="lineNum">    1029 </span><span class="lineCov">       3310 :               derivatives[i][1] += ((dSASA_2_neigh_dc[1]*LCPOparam[Nlist[i][j]][2] + dSASA_3_neigh_dc[1]*LCPOparam[Nlist[i][j]][3]+dSASA_4_neigh_dc[1]*LCPOparam[Nlist[i][j]][4])/MaxSurf[Nlist[i][j]][1]*DeltaG[Nlist[i][j]][0])*10;</span></a>
<a name="1030"><span class="lineNum">    1030 </span><span class="lineCov">       3310 :               derivatives[i][2] += ((dSASA_2_neigh_dc[2]*LCPOparam[Nlist[i][j]][2] + dSASA_3_neigh_dc[2]*LCPOparam[Nlist[i][j]][3]+dSASA_4_neigh_dc[2]*LCPOparam[Nlist[i][j]][4])/MaxSurf[Nlist[i][j]][1]*DeltaG[Nlist[i][j]][0])*10;</span></a>
<a name="1031"><span class="lineNum">    1031 </span>            :             }</a>
<a name="1032"><span class="lineNum">    1032 </span>            : </a>
<a name="1033"><span class="lineNum">    1033 </span><span class="lineCov">      19030 :             Aijk += (Aijt * Ajkt);</span></a>
<a name="1034"><span class="lineNum">    1034 </span><span class="lineCov">      19030 :             Aij += Aijt;</span></a>
<a name="1035"><span class="lineNum">    1035 </span><span class="lineCov">      19030 :             Ajk += Ajkt;</span></a>
<a name="1036"><span class="lineNum">    1036 </span>            : </a>
<a name="1037"><span class="lineNum">    1037 </span><span class="lineCov">      19030 :             dAijdc_2[0] += dAijdc_2t[0];</span></a>
<a name="1038"><span class="lineNum">    1038 </span><span class="lineCov">      19030 :             dAijdc_2[1] += dAijdc_2t[1];</span></a>
<a name="1039"><span class="lineNum">    1039 </span><span class="lineCov">      19030 :             dAijdc_2[2] += dAijdc_2t[2];</span></a>
<a name="1040"><span class="lineNum">    1040 </span>            : </a>
<a name="1041"><span class="lineNum">    1041 </span><span class="lineCov">      19030 :             dAijdc_4[0] += Ajkt*dAijdc_2t[0];</span></a>
<a name="1042"><span class="lineNum">    1042 </span><span class="lineCov">      19030 :             dAijdc_4[1] += Ajkt*dAijdc_2t[1];</span></a>
<a name="1043"><span class="lineNum">    1043 </span><span class="lineCov">      19030 :             dAijdc_4[2] += Ajkt*dAijdc_2t[2];</span></a>
<a name="1044"><span class="lineNum">    1044 </span>            : </a>
<a name="1045"><span class="lineNum">    1045 </span>            :           }</a>
<a name="1046"><span class="lineNum">    1046 </span>            :           double sasai = (LCPOparam[i][1]*S1+LCPOparam[i][2]*Aij+LCPOparam[i][3]*Ajk+LCPOparam[i][4]*Aijk);</a>
<a name="1047"><span class="lineNum">    1047 </span>            : </a>
<a name="1048"><span class="lineNum">    1048 </span><span class="lineCov">       2016 :           if (AtomResidueName[0][i] == &quot;N&quot; || AtomResidueName[0][i] == &quot;CA&quot;  || AtomResidueName[0][i] == &quot;C&quot; || AtomResidueName[0][i] == &quot;O&quot;) {</span></a>
<a name="1049"><span class="lineNum">    1049 </span><span class="lineCov">        576 :             if (sasai &gt; 0 ) sasa += (sasai/MaxSurf[i][0]*DeltaG[natoms][0]);</span></a>
<a name="1050"><span class="lineNum">    1050 </span><span class="lineCov">        576 :             derivatives[i][0] += ((dAijdc_2[0]*LCPOparam[i][2]+dAijdc_4[0]*LCPOparam[i][4])/MaxSurf[i][0]*DeltaG[natoms][0])*10;</span></a>
<a name="1051"><span class="lineNum">    1051 </span><span class="lineCov">        576 :             derivatives[i][1] += ((dAijdc_2[1]*LCPOparam[i][2]+dAijdc_4[1]*LCPOparam[i][4])/MaxSurf[i][0]*DeltaG[natoms][0])*10;</span></a>
<a name="1052"><span class="lineNum">    1052 </span><span class="lineCov">        576 :             derivatives[i][2] += ((dAijdc_2[2]*LCPOparam[i][2]+dAijdc_4[2]*LCPOparam[i][4])/MaxSurf[i][0]*DeltaG[natoms][0])*10;</span></a>
<a name="1053"><span class="lineNum">    1053 </span>            :           }</a>
<a name="1054"><span class="lineNum">    1054 </span>            : </a>
<a name="1055"><span class="lineNum">    1055 </span><span class="lineCov">       2016 :           if (AtomResidueName[0][i] != &quot;N&quot; &amp;&amp; AtomResidueName[0][i] != &quot;CA&quot;  &amp;&amp; AtomResidueName[0][i] != &quot;C&quot; &amp;&amp; AtomResidueName[0][i] != &quot;O&quot;) {</span></a>
<a name="1056"><span class="lineNum">    1056 </span><span class="lineCov">        144 :             if (sasai &gt; 0. ) sasa += (sasai/MaxSurf[i][1]*DeltaG[i][0]);</span></a>
<a name="1057"><span class="lineNum">    1057 </span><span class="lineCov">        144 :             derivatives[i][0] += ((dAijdc_2[0]*LCPOparam[i][2]+dAijdc_4[0]*LCPOparam[i][4])/MaxSurf[i][1]*DeltaG[i][0])*10;</span></a>
<a name="1058"><span class="lineNum">    1058 </span><span class="lineCov">        144 :             derivatives[i][1] += ((dAijdc_2[1]*LCPOparam[i][2]+dAijdc_4[1]*LCPOparam[i][4])/MaxSurf[i][1]*DeltaG[i][0])*10;</span></a>
<a name="1059"><span class="lineNum">    1059 </span><span class="lineCov">        144 :             derivatives[i][2] += ((dAijdc_2[2]*LCPOparam[i][2]+dAijdc_4[2]*LCPOparam[i][4])/MaxSurf[i][1]*DeltaG[i][0])*10;</span></a>
<a name="1060"><span class="lineNum">    1060 </span>            :           }</a>
<a name="1061"><span class="lineNum">    1061 </span>            :         }</a>
<a name="1062"><span class="lineNum">    1062 </span>            :       }</a>
<a name="1063"><span class="lineNum">    1063 </span><span class="lineCov">       1440 :       virial -= Tensor(getPosition(i),derivatives[i]);</span></a>
<a name="1064"><span class="lineNum">    1064 </span>            :     }</a>
<a name="1065"><span class="lineNum">    1065 </span>            :   }</a>
<a name="1066"><span class="lineNum">    1066 </span>            : </a>
<a name="1067"><span class="lineNum">    1067 </span>            : </a>
<a name="1068"><span class="lineNum">    1068 </span><span class="lineCov">       2904 :   for(unsigned i=0; i&lt;natoms; i++) { setAtomsDerivatives(i,derivatives[i]);}</span></a>
<a name="1069"><span class="lineNum">    1069 </span><span class="lineCov">         24 :   setBoxDerivatives(virial);</span></a>
<a name="1070"><span class="lineNum">    1070 </span><span class="lineCov">         24 :   setValue(sasa);</span></a>
<a name="1071"><span class="lineNum">    1071 </span><span class="lineCov">         24 :   firstStepFlag = 1;</span></a>
<a name="1072"><span class="lineNum">    1072 </span><span class="lineCov">         24 :   ++nl_update;</span></a>
<a name="1073"><span class="lineNum">    1073 </span><span class="lineCov">         24 :   if (nl_update == stride) {</span></a>
<a name="1074"><span class="lineNum">    1074 </span><span class="lineCov">         24 :     nl_update = 0;</span></a>
<a name="1075"><span class="lineNum">    1075 </span>            :   }</a>
<a name="1076"><span class="lineNum">    1076 </span>            : // setBoxDerivativesNoPbc();</a>
<a name="1077"><span class="lineNum">    1077 </span><span class="lineCov">         24 : }</span></a>
<a name="1078"><span class="lineNum">    1078 </span>            : </a>
<a name="1079"><span class="lineNum">    1079 </span>            : }//namespace sasa</a>
<a name="1080"><span class="lineNum">    1080 </span>            : }//namespace PLMD</a>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="https://github.com/linux-test-project/lcov" target="_parent">LCOV version 1.16</a></td></tr>
  </table>
  <br>

</body>
</html>
